var tt=Object.create;var Ze=Object.defineProperty;var rt=Object.getOwnPropertyDescriptor;var it=Object.getOwnPropertyNames;var ot=Object.getPrototypeOf,at=Object.prototype.hasOwnProperty;var st=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),_n=(n,e)=>{for(var t in e)Ze(n,t,{get:e[t],enumerable:!0})},ut=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of it(e))!at.call(n,r)&&r!==t&&Ze(n,r,{get:()=>e[r],enumerable:!(i=rt(e,r))||i.enumerable});return n};var ct=(n,e,t)=>(t=n!=null?tt(ot(n)):{},ut(e||!n||!n.__esModule?Ze(t,"default",{value:n,enumerable:!0}):t,n));var Xn=st((exports,module)=>{"use strict";var numeric=typeof exports>"u"?function(){}:exports;window.numeric=numeric;typeof global<"u"&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(n,e){var t,i,r,o;for(typeof e>"u"&&(e=15),r=.5,t=new Date;;){for(r*=2,o=r;o>3;o-=4)n(),n(),n(),n();for(;o>0;)n(),o--;if(i=new Date,i-t>e)break}for(o=r;o>3;o-=4)n(),n(),n(),n();for(;o>0;)n(),o--;return i=new Date,1e3*(3*r-1)/(i-t)},numeric._myIndexOf=function(n){var e=this.length,t;for(t=0;t<e;++t)if(this[t]===n)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(n){function e(r){if(r===0)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+e(-r);if(isFinite(r)){var o=Math.floor(Math.log(r)/Math.log(10)),a=r/Math.pow(10,o),s=a.toPrecision(numeric.precision);return parseFloat(s)===10&&(o++,a=1,s=a.toPrecision(numeric.precision)),parseFloat(s).toString()+"e"+o.toString()}return"Infinity"}function t(r){var o;if(typeof r>"u")return i.push(Array(numeric.precision+8).join(" ")),!1;if(typeof r=="string")return i.push('"'+r+'"'),!1;if(typeof r=="boolean")return i.push(r.toString()),!1;if(typeof r=="number"){var a=e(r),s=r.toPrecision(numeric.precision),u=parseFloat(r.toString()).toString(),f=[a,s,u,parseFloat(s).toString(),parseFloat(u).toString()];for(o=1;o<f.length;o++)f[o].length<a.length&&(a=f[o]);return i.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(r===null)return i.push("null"),!1;if(typeof r=="function"){i.push(r.toString());var l=!1;for(o in r)r.hasOwnProperty(o)&&(l?i.push(`,
`):i.push(`
{`),l=!0,i.push(o),i.push(`: 
`),t(r[o]));return l&&i.push(`}
`),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return i.push("...Large Array..."),!0;var l=!1;for(i.push("["),o=0;o<r.length;o++)o>0&&(i.push(","),l&&i.push(`
 `)),l=t(r[o]);return i.push("]"),!0}i.push("{");var l=!1;for(o in r)r.hasOwnProperty(o)&&(l&&i.push(`,
`),l=!0,i.push(o),i.push(`: 
`),t(r[o]));return i.push("}"),!0}var i=[];return t(n),i.join("")},numeric.parseDate=function(n){function e(t){if(typeof t=="string")return Date.parse(t.replace(/-/g,"/"));if(t instanceof Array){var i=[],r;for(r=0;r<t.length;r++)i[r]=e(t[r]);return i}throw new Error("parseDate: parameter must be arrays of strings")}return e(n)},numeric.parseFloat=function(n){function e(t){if(typeof t=="string")return parseFloat(t);if(t instanceof Array){var i=[],r;for(r=0;r<t.length;r++)i[r]=e(t[r]);return i}throw new Error("parseFloat: parameter must be arrays of strings")}return e(n)},numeric.parseCSV=function(n){var e=n.split(`
`),t,i,r=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,s=function(c){return c.substr(0,c.length-1)},u=0;for(i=0;i<e.length;i++){var f=(e[i]+",").match(o),l;if(f.length>0){for(r[u]=[],t=0;t<f.length;t++)l=s(f[t]),a.test(l)?r[u][t]=parseFloat(l):r[u][t]=l;u++}}return r},numeric.toCSV=function(n){var e=numeric.dim(n),t,i,r,o,a,s;for(r=e[0],o=e[1],s=[],t=0;t<r;t++){for(a=[],i=0;i<r;i++)a[i]=n[t][i].toString();s[t]=a.join(", ")}return s.join(`
`)+`
`},numeric.getURL=function(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(),e},numeric.imageURL=function(n){function e(w){var M=w.length,x,g,b,_,E,R,F,P,D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",I="";for(x=0;x<M;x+=3)g=w[x],b=w[x+1],_=w[x+2],E=g>>2,R=((g&3)<<4)+(b>>4),F=((b&15)<<2)+(_>>6),P=_&63,x+1>=M?F=P=64:x+2>=M&&(P=64),I+=D.charAt(E)+D.charAt(R)+D.charAt(F)+D.charAt(P);return I}function t(w,M,x){typeof M>"u"&&(M=0),typeof x>"u"&&(x=w.length);var g=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],b=-1,_=0,E=w.length,R;for(R=M;R<x;R++)_=(b^w[R])&255,b=b>>>8^g[_];return b^-1}var i=n[0].length,r=n[0][0].length,o,a,s,u,f,l,c,m,d,h,p,v=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,r>>24&255,r>>16&255,r>>8&255,r&255,i>>24&255,i>>16&255,i>>8&255,i&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(p=t(v,12,29),v[29]=p>>24&255,v[30]=p>>16&255,v[31]=p>>8&255,v[32]=p&255,o=1,a=0,m=0;m<i;m++){for(m<i-1?v.push(0):v.push(1),l=3*r+1+(m===0)&255,c=3*r+1+(m===0)>>8&255,v.push(l),v.push(c),v.push(~l&255),v.push(~c&255),m===0&&v.push(0),d=0;d<r;d++)for(u=0;u<3;u++)l=n[u][m][d],l>255?l=255:l<0?l=0:l=Math.round(l),o=(o+l)%65521,a=(a+o)%65521,v.push(l);v.push(0)}return h=(a<<16)+o,v.push(h>>24&255),v.push(h>>16&255),v.push(h>>8&255),v.push(h&255),f=v.length-41,v[33]=f>>24&255,v[34]=f>>16&255,v[35]=f>>8&255,v[36]=f&255,p=t(v,37),v.push(p>>24&255),v.push(p>>16&255),v.push(p>>8&255),v.push(p&255),v.push(0),v.push(0),v.push(0),v.push(0),v.push(73),v.push(69),v.push(78),v.push(68),v.push(174),v.push(66),v.push(96),v.push(130),"data:image/png;base64,"+e(v)},numeric._dim=function(n){for(var e=[];typeof n=="object";)e.push(n.length),n=n[0];return e},numeric.dim=function(n){var e,t;return typeof n=="object"?(e=n[0],typeof e=="object"?(t=e[0],typeof t=="object"?numeric._dim(n):[n.length,e.length]):[n.length]):[]},numeric.mapreduce=function(n,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+`;
if(typeof x === "number") { var xi = x; `+n+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+n+`;
    xi = x[i-1];
    `+n+`;
}
if(i === 0) {
    xi = x[i];
    `+n+`
}
return accum;`)},numeric.mapreduce2=function(n,e){return Function("x",`var n = x.length;
var i,xi;
`+e+`;
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+n+`;
}
return accum;`)},numeric.same=function n(e,t){var i,r;if(e instanceof Array&&t instanceof Array){if(r=e.length,r!==t.length)return!1;for(i=0;i<r;i++)if(e[i]!==t[i]&&(typeof e[i]!="object"||!n(e[i],t[i])))return!1;return!0}return!1},numeric.rep=function(n,e,t){typeof t>"u"&&(t=0);var i=n[t],r=Array(i),o;if(t===n.length-1){for(o=i-2;o>=0;o-=2)r[o+1]=e,r[o]=e;return o===-1&&(r[0]=e),r}for(o=i-1;o>=0;o--)r[o]=numeric.rep(n,e,t+1);return r},numeric.dotMMsmall=function(n,e){var t,i,r,o,a,s,u,f,l,c,m,d,h,p;for(o=n.length,a=e.length,s=e[0].length,u=Array(o),t=o-1;t>=0;t--){for(f=Array(s),l=n[t],r=s-1;r>=0;r--){for(c=l[a-1]*e[a-1][r],i=a-2;i>=1;i-=2)m=i-1,c+=l[i]*e[i][r]+l[m]*e[m][r];i===0&&(c+=l[0]*e[0][r]),f[r]=c}u[t]=f}return u},numeric._getCol=function(n,e,t){var i=n.length,r;for(r=i-1;r>0;--r)t[r]=n[r][e],--r,t[r]=n[r][e];r===0&&(t[0]=n[0][e])},numeric.dotMMbig=function(n,e){var t=numeric._getCol,i=e.length,r=Array(i),o=n.length,a=e[0].length,s=new Array(o),u,f=numeric.dotVV,l,c,m,d;for(--i,--o,l=o;l!==-1;--l)s[l]=Array(a);for(--a,l=a;l!==-1;--l)for(t(e,l,r),c=o;c!==-1;--c)d=0,u=n[c],s[c][l]=f(u,r);return s},numeric.dotMV=function(n,e){var t=n.length,i=e.length,r,o=Array(t),a=numeric.dotVV;for(r=t-1;r>=0;r--)o[r]=a(n[r],e);return o},numeric.dotVM=function(n,e){var t,i,r,o,a,s,u,f,l,c,m,d,h,p,v,w,M,x,g;for(o=n.length,a=e[0].length,u=Array(a),r=a-1;r>=0;r--){for(c=n[o-1]*e[o-1][r],i=o-2;i>=1;i-=2)m=i-1,c+=n[i]*e[i][r]+n[m]*e[m][r];i===0&&(c+=n[0]*e[0][r]),u[r]=c}return u},numeric.dotVV=function(n,e){var t,i=n.length,r,o=n[i-1]*e[i-1];for(t=i-2;t>=1;t-=2)r=t-1,o+=n[t]*e[t]+n[r]*e[r];return t===0&&(o+=n[0]*e[0]),o},numeric.dot=function(n,e){var t=numeric.dim;switch(t(n).length*1e3+t(e).length){case 2002:return e.length<10?numeric.dotMMsmall(n,e):numeric.dotMMbig(n,e);case 2001:return numeric.dotMV(n,e);case 1002:return numeric.dotVM(n,e);case 1001:return numeric.dotVV(n,e);case 1e3:return numeric.mulVS(n,e);case 1:return numeric.mulSV(n,e);case 0:return n*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(n){var e,t,i,r=n.length,o=Array(r),a;for(e=r-1;e>=0;e--){for(a=Array(r),t=e+2,i=r-1;i>=t;i-=2)a[i]=0,a[i-1]=0;for(i>e&&(a[i]=0),a[e]=n[e],i=e-1;i>=1;i-=2)a[i]=0,a[i-1]=0;i===0&&(a[0]=0),o[e]=a}return o},numeric.getDiag=function(n){var e=Math.min(n.length,n[0].length),t,i=Array(e);for(t=e-1;t>=1;--t)i[t]=n[t][t],--t,i[t]=n[t][t];return t===0&&(i[0]=n[0][0]),i},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(n,e,t){typeof t>"u"&&(t="");var i=[],r,o=/\[i\]$/,a,s="",u=!1;for(r=0;r<n.length;r++)o.test(n[r])?(a=n[r].substring(0,n[r].length-3),s=a):a=n[r],a==="ret"&&(u=!0),i.push(a);return i[n.length]="_s",i[n.length+1]="_k",i[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(u?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+n.join(",")+`,_s,_k+1);
    return ret;
}
`+t+`
for(i=_n-1;i!==-1;--i) {
    `+e+`
}
return ret;`,Function.apply(null,i)},numeric.pointwise2=function(n,e,t){typeof t>"u"&&(t="");var i=[],r,o=/\[i\]$/,a,s="",u=!1;for(r=0;r<n.length;r++)o.test(n[r])?(a=n[r].substring(0,n[r].length-3),s=a):a=n[r],a==="ret"&&(u=!0),i.push(a);return i[n.length]="var _n = "+s+`.length;
var i`+(u?"":", ret = Array(_n)")+`;
`+t+`
for(i=_n-1;i!==-1;--i) {
`+e+`
}
return ret;`,Function.apply(null,i)},numeric._biforeach=function n(e,t,i,r,o){if(r===i.length-1){o(e,t);return}var a,s=i[r];for(a=s-1;a>=0;a--)n(typeof e=="object"?e[a]:e,typeof t=="object"?t[a]:t,i,r+1,o)},numeric._biforeach2=function n(e,t,i,r,o){if(r===i.length-1)return o(e,t);var a,s=i[r],u=Array(s);for(a=s-1;a>=0;--a)u[a]=n(typeof e=="object"?e[a]:e,typeof t=="object"?t[a]:t,i,r+1,o);return u},numeric._foreach=function n(e,t,i,r){if(i===t.length-1){r(e);return}var o,a=t[i];for(o=a-1;o>=0;o--)n(e[o],t,i+1,r)},numeric._foreach2=function n(e,t,i,r){if(i===t.length-1)return r(e);var o,a=t[i],s=Array(a);for(o=a-1;o>=0;o--)s[o]=n(e[o],t,i+1,r);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},(function(){var n,e;for(n=0;n<numeric.mathfuns2.length;++n)e=numeric.mathfuns2[n],numeric.ops2[e]=e;for(n in numeric.ops2)if(numeric.ops2.hasOwnProperty(n)){e=numeric.ops2[n];var t,i,r="";numeric.myIndexOf.call(numeric.mathfuns2,n)!==-1?(r="var "+e+" = Math."+e+`;
`,t=function(o,a,s){return o+" = "+e+"("+a+","+s+")"},i=function(o,a){return o+" = "+e+"("+o+","+a+")"}):(t=function(o,a,s){return o+" = "+a+" "+e+" "+s},numeric.opseq.hasOwnProperty(n+"eq")?i=function(o,a){return o+" "+e+"= "+a}:i=function(o,a){return o+" = "+o+" "+e+" "+a}),numeric[n+"VV"]=numeric.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),r),numeric[n+"SV"]=numeric.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),r),numeric[n+"VS"]=numeric.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),r),numeric[n]=Function(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+n+"VV, VS = numeric."+n+"VS, SV = numeric."+n+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+i("x","y")+`
}
return x;
`),numeric[e]=numeric[n],numeric[n+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),r),numeric[n+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),r),numeric[n+"eq"]=Function(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+n+"eqV, S = numeric."+n+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(n=0;n<numeric.mathfuns2.length;++n)e=numeric.mathfuns2[n],delete numeric.ops2[e];for(n=0;n<numeric.mathfuns.length;++n)e=numeric.mathfuns[n],numeric.ops1[e]=e;for(n in numeric.ops1)numeric.ops1.hasOwnProperty(n)&&(r="",e=numeric.ops1[n],numeric.myIndexOf.call(numeric.mathfuns,n)!==-1&&Math.hasOwnProperty(e)&&(r="var "+e+" = Math."+e+`;
`),numeric[n+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",r),numeric[n+"eq"]=Function("x",'if(typeof x !== "object") return '+e+`x
var i;
var V = numeric.`+n+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),numeric[n+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",r),numeric[n]=Function("x",'if(typeof x !== "object") return '+e+`(x)
var i;
var V = numeric.`+n+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(n=0;n<numeric.mathfuns.length;++n)e=numeric.mathfuns[n],delete numeric.ops1[e];for(n in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(n)&&(e=numeric.mapreducers[n],numeric[n+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[n]=Function("x","s","k",e[1]+`if(typeof x !== "object") {    xi = x;
`+e[0]+`;
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+n+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+e[0]+`;
}
return accum;
`))})(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(n,e){return typeof n=="object"?typeof e=="object"?numeric.truncVV(n,e):numeric.truncVS(n,e):typeof e=="object"?numeric.truncSV(n,e):Math.round(n/e)*e},numeric.inv=function(h){var e=numeric.dim(h),t=Math.abs,i=e[0],r=e[1],o=numeric.clone(h),a,s,u=numeric.identity(i),f,l,c,m,d,h;for(m=0;m<r;++m){var p=-1,v=-1;for(c=m;c!==i;++c)d=t(o[c][m]),d>v&&(p=c,v=d);for(s=o[p],o[p]=o[m],o[m]=s,l=u[p],u[p]=u[m],u[m]=l,h=s[m],d=m;d!==r;++d)s[d]/=h;for(d=r-1;d!==-1;--d)l[d]/=h;for(c=i-1;c!==-1;--c)if(c!==m){for(a=o[c],f=u[c],h=a[m],d=m+1;d!==r;++d)a[d]-=s[d]*h;for(d=r-1;d>0;--d)f[d]-=l[d]*h,--d,f[d]-=l[d]*h;d===0&&(f[0]-=l[0]*h)}}return u},numeric.det=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var t=e[0],i=1,r,o,a,s=numeric.clone(n),u,f,l,c,m,d,h;for(o=0;o<t-1;o++){for(a=o,r=o+1;r<t;r++)Math.abs(s[r][o])>Math.abs(s[a][o])&&(a=r);for(a!==o&&(c=s[a],s[a]=s[o],s[o]=c,i*=-1),u=s[o],r=o+1;r<t;r++){for(f=s[r],l=f[o]/u[o],a=o+1;a<t-1;a+=2)m=a+1,f[a]-=u[a]*l,f[m]-=u[m]*l;a!==t&&(f[a]-=u[a]*l)}if(u[o]===0)return 0;i*=u[o]}return i*s[o][o]},numeric.transpose=function(n){var e,t,i=n.length,r=n[0].length,o=Array(r),a,s,u;for(t=0;t<r;t++)o[t]=Array(i);for(e=i-1;e>=1;e-=2){for(s=n[e],a=n[e-1],t=r-1;t>=1;--t)u=o[t],u[e]=s[t],u[e-1]=a[t],--t,u=o[t],u[e]=s[t],u[e-1]=a[t];t===0&&(u=o[0],u[e]=s[0],u[e-1]=a[0])}if(e===0){for(a=n[0],t=r-1;t>=1;--t)o[t][0]=a[t],--t,o[t][0]=a[t];t===0&&(o[0][0]=a[0])}return o},numeric.negtranspose=function(n){var e,t,i=n.length,r=n[0].length,o=Array(r),a,s,u;for(t=0;t<r;t++)o[t]=Array(i);for(e=i-1;e>=1;e-=2){for(s=n[e],a=n[e-1],t=r-1;t>=1;--t)u=o[t],u[e]=-s[t],u[e-1]=-a[t],--t,u=o[t],u[e]=-s[t],u[e-1]=-a[t];t===0&&(u=o[0],u[e]=-s[0],u[e-1]=-a[0])}if(e===0){for(a=n[0],t=r-1;t>=1;--t)o[t][0]=-a[t],--t,o[t][0]=-a[t];t===0&&(o[0][0]=-a[0])}return o},numeric._random=function n(e,t){var i,r=e[t],o=Array(r),a;if(t===e.length-1){for(a=Math.random,i=r-1;i>=1;i-=2)o[i]=a(),o[i-1]=a();return i===0&&(o[0]=a()),o}for(i=r-1;i>=0;i--)o[i]=n(e,t+1);return o},numeric.random=function(n){return numeric._random(n,0)},numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.linspace=function(n,e,t){if(typeof t>"u"&&(t=Math.max(Math.round(e-n)+1,1)),t<2)return t===1?[n]:[];var i,r=Array(t);for(t--,i=t;i>=0;i--)r[i]=(i*e+(t-i)*n)/t;return r},numeric.getBlock=function(n,e,t){function i(o,a){var s,u=e[a],f=t[a]-u,l=Array(f);if(a===r.length-1){for(s=f;s>=0;s--)l[s]=o[s+u];return l}for(s=f;s>=0;s--)l[s]=i(o[s+u],a+1);return l}var r=numeric.dim(n);return i(n,0)},numeric.setBlock=function(n,e,t,i){function r(a,s,u){var f,l=e[u],c=t[u]-l;if(u===o.length-1)for(f=c;f>=0;f--)a[f+l]=s[f];for(f=c;f>=0;f--)r(a[f+l],s[f],u+1)}var o=numeric.dim(n);return r(n,i,0),n},numeric.getRange=function(n,e,t){var i=e.length,r=t.length,o,a,s=Array(i),u,f;for(o=i-1;o!==-1;--o)for(s[o]=Array(r),u=s[o],f=n[e[o]],a=r-1;a!==-1;--a)u[a]=f[t[a]];return s},numeric.blockMatrix=function(n){var e=numeric.dim(n);if(e.length<4)return numeric.blockMatrix([n]);var t=e[0],i=e[1],r,o,a,s,u;for(r=0,o=0,a=0;a<t;++a)r+=n[a][0].length;for(s=0;s<i;++s)o+=n[0][s][0].length;var f=Array(r);for(a=0;a<r;++a)f[a]=Array(o);var l=0,c,m,d,h,p;for(a=0;a<t;++a){for(c=o,s=i-1;s!==-1;--s)for(u=n[a][s],c-=u[0].length,d=u.length-1;d!==-1;--d)for(p=u[d],m=f[l+d],h=p.length-1;h!==-1;--h)m[c+h]=p[h];l+=n[a][0].length}return f},numeric.tensor=function(n,e){if(typeof n=="number"||typeof e=="number")return numeric.mul(n,e);var t=numeric.dim(n),i=numeric.dim(e);if(t.length!==1||i.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var r=t[0],o=i[0],a=Array(r),s,u,f,l;for(u=r-1;u>=0;u--){for(s=Array(o),l=n[u],f=o-1;f>=3;--f)s[f]=l*e[f],--f,s[f]=l*e[f],--f,s[f]=l*e[f],--f,s[f]=l*e[f];for(;f>=0;)s[f]=l*e[f],--f;a[u]=s}return a},numeric.T=function(n,e){this.x=n,this.y=e},numeric.t=function(n,e){return new numeric.T(n,e)},numeric.Tbinop=function(n,e,t,i,r){var o=numeric.indexOf;if(typeof r!="string"){var a;r="";for(a in numeric)numeric.hasOwnProperty(a)&&(n.indexOf(a)>=0||e.indexOf(a)>=0||t.indexOf(a)>=0||i.indexOf(a)>=0)&&a.length>1&&(r+="var "+a+" = numeric."+a+`;
`)}return Function(["y"],`var x = this;
if(!(y instanceof numeric.T)) { y = new numeric.T(y); }
`+r+`
if(x.y) {  if(y.y) {    return new numeric.T(`+i+`);
  }
  return new numeric.T(`+t+`);
}
if(y.y) {
  return new numeric.T(`+e+`);
}
return new numeric.T(`+n+`);
`)},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var n=numeric.mul,e=numeric.div;if(this.y){var t=numeric.add(n(this.x,this.x),n(this.y,this.y));return new numeric.T(e(this.x,t),e(numeric.neg(this.y),t))}return new T(e(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var n=numeric.transpose,e=this.x,t=this.y;return t?new numeric.T(n(e),n(t)):new numeric.T(n(e))},numeric.T.prototype.transjugate=function(){var n=numeric.transpose,e=this.x,t=this.y;return t?new numeric.T(n(e),numeric.negtranspose(t)):new numeric.T(n(e))},numeric.Tunop=function(n,e,t){return typeof t!="string"&&(t=""),Function(`var x = this;
`+t+`
if(x.y) {  `+e+`;
}
`+n+`;
`)},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));",`var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();
return new numeric.T(numeric.log(r.x),theta.x);`),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);",`var f = numeric.norm2Squared;
return Math.sqrt(f(x.x)+f(x.y));`),numeric.T.prototype.inv=function(){var n=this;if(typeof n.y>"u")return new numeric.T(numeric.inv(n.x));var e=n.x.length,h,p,v,t=numeric.identity(e),i=numeric.rep([e,e],0),r=numeric.clone(n.x),o=numeric.clone(n.y),a,s,u,f,l,c,m,d,h,p,v,w,M,x,g,b,_,E;for(h=0;h<e;h++){for(x=r[h][h],g=o[h][h],w=x*x+g*g,v=h,p=h+1;p<e;p++)x=r[p][h],g=o[p][h],M=x*x+g*g,M>w&&(v=p,w=M);for(v!==h&&(E=r[h],r[h]=r[v],r[v]=E,E=o[h],o[h]=o[v],o[v]=E,E=t[h],t[h]=t[v],t[v]=E,E=i[h],i[h]=i[v],i[v]=E),a=r[h],s=o[h],l=t[h],c=i[h],x=a[h],g=s[h],p=h+1;p<e;p++)b=a[p],_=s[p],a[p]=(b*x+_*g)/w,s[p]=(_*x-b*g)/w;for(p=0;p<e;p++)b=l[p],_=c[p],l[p]=(b*x+_*g)/w,c[p]=(_*x-b*g)/w;for(p=h+1;p<e;p++){for(u=r[p],f=o[p],m=t[p],d=i[p],x=u[h],g=f[h],v=h+1;v<e;v++)b=a[v],_=s[v],u[v]-=b*x-_*g,f[v]-=_*x+b*g;for(v=0;v<e;v++)b=l[v],_=c[v],m[v]-=b*x-_*g,d[v]-=_*x+b*g}}for(h=e-1;h>0;h--)for(l=t[h],c=i[h],p=h-1;p>=0;p--)for(m=t[p],d=i[p],x=r[p][h],g=o[p][h],v=e-1;v>=0;v--)b=l[v],_=c[v],m[v]-=x*b-g*_,d[v]-=x*_+g*b;return new numeric.T(t,i)},numeric.T.prototype.get=function(n){var e=this.x,t=this.y,i=0,r,o=n.length;if(t){for(;i<o;)r=n[i],e=e[r],t=t[r],i++;return new numeric.T(e,t)}for(;i<o;)r=n[i],e=e[r],i++;return new numeric.T(e)},numeric.T.prototype.set=function(n,e){var t=this.x,i=this.y,r=0,o,a=n.length,s=e.x,u=e.y;if(a===0)return u?this.y=u:i&&(this.y=void 0),this.x=t,this;if(u){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);r<a-1;)o=n[r],t=t[o],i=i[o],r++;return o=n[r],t[o]=s,i[o]=u,this}if(i){for(;r<a-1;)o=n[r],t=t[o],i=i[o],r++;return o=n[r],t[o]=s,s instanceof Array?i[o]=numeric.rep(numeric.dim(s),0):i[o]=0,this}for(;r<a-1;)o=n[r],t=t[o],r++;return o=n[r],t[o]=s,this},numeric.T.prototype.getRows=function(n,e){var t=e-n+1,i,r=Array(t),o,a=this.x,s=this.y;for(i=n;i<=e;i++)r[i-n]=a[i];if(s){for(o=Array(t),i=n;i<=e;i++)o[i-n]=s[i];return new numeric.T(r,o)}return new numeric.T(r)},numeric.T.prototype.setRows=function(n,e,t){var i,r=this.x,o=this.y,a=t.x,s=t.y;for(i=n;i<=e;i++)r[i]=a[i-n];if(s)for(o||(o=numeric.rep(numeric.dim(r),0),this.y=o),i=n;i<=e;i++)o[i]=s[i-n];else if(o)for(i=n;i<=e;i++)o[i]=numeric.rep([a[i-n].length],0);return this},numeric.T.prototype.getRow=function(n){var e=this.x,t=this.y;return t?new numeric.T(e[n],t[n]):new numeric.T(e[n])},numeric.T.prototype.setRow=function(n,e){var t=this.x,i=this.y,r=e.x,o=e.y;return t[n]=r,o?(i||(i=numeric.rep(numeric.dim(t),0),this.y=i),i[n]=o):i&&(i=numeric.rep([r.length],0)),this},numeric.T.prototype.getBlock=function(n,e){var t=this.x,i=this.y,r=numeric.getBlock;return i?new numeric.T(r(t,n,e),r(i,n,e)):new numeric.T(r(t,n,e))},numeric.T.prototype.setBlock=function(n,e,t){t instanceof numeric.T||(t=new numeric.T(t));var i=this.x,r=this.y,o=numeric.setBlock,a=t.x,s=t.y;if(s)return r||(this.y=numeric.rep(numeric.dim(this),0),r=this.y),o(i,n,e,a),o(r,n,e,s),this;o(i,n,e,a),r&&o(r,n,e,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(n,e){var t=numeric.T;e instanceof t||(e=new t(e));var i=e.x,r=e.y,o=numeric.rep;return r?new t(o(n,i),o(n,r)):new t(o(n,i))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,i=e.y,r=numeric.diag;return i?new numeric.T(r(t),r(i)):new numeric.T(r(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,e=this.x,t=this.y;return t?new n.T(n.getDiag(e),n.getDiag(t)):new n.T(n.getDiag(e))},numeric.house=function(n){var e=numeric.clone(n),t=n[0]>=0?1:-1,i=t*numeric.norm2(n);e[0]+=i;var r=numeric.norm2(e);if(r===0)throw new Error("eig: internal error");return numeric.div(e,r)},numeric.toUpperHessenberg=function(n){var e=numeric.dim(n);if(e.length!==2||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var t=e[0],i,r,o,a,s,u=numeric.clone(n),f,l,c,m,d=numeric.identity(t),h;for(r=0;r<t-2;r++){for(a=Array(t-r-1),i=r+1;i<t;i++)a[i-r-1]=u[i][r];if(numeric.norm2(a)>0){for(s=numeric.house(a),f=numeric.getBlock(u,[r+1,r],[t-1,t-1]),l=numeric.tensor(s,numeric.dot(s,f)),i=r+1;i<t;i++)for(c=u[i],m=l[i-r-1],o=r;o<t;o++)c[o]-=2*m[o-r];for(f=numeric.getBlock(u,[0,r+1],[t-1,t-1]),l=numeric.tensor(numeric.dot(f,s),s),i=0;i<t;i++)for(c=u[i],m=l[i],o=r+1;o<t;o++)c[o]-=2*m[o-r-1];for(f=Array(t-r-1),i=r+1;i<t;i++)f[i-r-1]=d[i];for(l=numeric.tensor(s,numeric.dot(s,f)),i=r+1;i<t;i++)for(h=d[i],m=l[i-r-1],o=0;o<t;o++)h[o]-=2*m[o]}}return{H:u,Q:d}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(n,e){typeof e>"u"&&(e=1e4),n=numeric.clone(n);var t=numeric.clone(n),i=numeric.dim(n),r=i[0],o,a,s,u,f,l,c,m,d,h=numeric.identity(r),p,v,w,M,x,g,b,_,E;if(r<3)return{Q:h,B:[[0,r-1]]};var R=numeric.epsilon;for(E=0;E<e;E++){for(b=0;b<r-1;b++)if(Math.abs(n[b+1][b])<R*(Math.abs(n[b][b])+Math.abs(n[b+1][b+1]))){var F=numeric.QRFrancis(numeric.getBlock(n,[0,0],[b,b]),e),P=numeric.QRFrancis(numeric.getBlock(n,[b+1,b+1],[r-1,r-1]),e);for(w=Array(b+1),g=0;g<=b;g++)w[g]=h[g];for(M=numeric.dot(F.Q,w),g=0;g<=b;g++)h[g]=M[g];for(w=Array(r-b-1),g=b+1;g<r;g++)w[g-b-1]=h[g];for(M=numeric.dot(P.Q,w),g=b+1;g<r;g++)h[g]=M[g-b-1];return{Q:h,B:F.B.concat(numeric.add(P.B,b+1))}}if(s=n[r-2][r-2],u=n[r-2][r-1],f=n[r-1][r-2],l=n[r-1][r-1],m=s+l,c=s*l-u*f,d=numeric.getBlock(n,[0,0],[2,2]),m*m>=4*c){var D,I;D=.5*(m+Math.sqrt(m*m-4*c)),I=.5*(m-Math.sqrt(m*m-4*c)),d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,D+I)),numeric.diag(numeric.rep([3],D*I)))}else d=numeric.add(numeric.sub(numeric.dot(d,d),numeric.mul(d,m)),numeric.diag(numeric.rep([3],c)));for(o=[d[0][0],d[1][0],d[2][0]],a=numeric.house(o),w=[n[0],n[1],n[2]],M=numeric.tensor(a,numeric.dot(a,w)),g=0;g<3;g++)for(v=n[g],x=M[g],_=0;_<r;_++)v[_]-=2*x[_];for(w=numeric.getBlock(n,[0,0],[r-1,2]),M=numeric.tensor(numeric.dot(w,a),a),g=0;g<r;g++)for(v=n[g],x=M[g],_=0;_<3;_++)v[_]-=2*x[_];for(w=[h[0],h[1],h[2]],M=numeric.tensor(a,numeric.dot(a,w)),g=0;g<3;g++)for(p=h[g],x=M[g],_=0;_<r;_++)p[_]-=2*x[_];var y;for(b=0;b<r-2;b++){for(_=b;_<=b+1;_++)if(Math.abs(n[_+1][_])<R*(Math.abs(n[_][_])+Math.abs(n[_+1][_+1]))){var F=numeric.QRFrancis(numeric.getBlock(n,[0,0],[_,_]),e),P=numeric.QRFrancis(numeric.getBlock(n,[_+1,_+1],[r-1,r-1]),e);for(w=Array(_+1),g=0;g<=_;g++)w[g]=h[g];for(M=numeric.dot(F.Q,w),g=0;g<=_;g++)h[g]=M[g];for(w=Array(r-_-1),g=_+1;g<r;g++)w[g-_-1]=h[g];for(M=numeric.dot(P.Q,w),g=_+1;g<r;g++)h[g]=M[g-_-1];return{Q:h,B:F.B.concat(numeric.add(P.B,_+1))}}for(y=Math.min(r-1,b+3),o=Array(y-b),g=b+1;g<=y;g++)o[g-b-1]=n[g][b];for(a=numeric.house(o),w=numeric.getBlock(n,[b+1,b],[y,r-1]),M=numeric.tensor(a,numeric.dot(a,w)),g=b+1;g<=y;g++)for(v=n[g],x=M[g-b-1],_=b;_<r;_++)v[_]-=2*x[_-b];for(w=numeric.getBlock(n,[0,b+1],[r-1,y]),M=numeric.tensor(numeric.dot(w,a),a),g=0;g<r;g++)for(v=n[g],x=M[g],_=b+1;_<=y;_++)v[_]-=2*x[_-b-1];for(w=Array(y-b),g=b+1;g<=y;g++)w[g-b-1]=h[g];for(M=numeric.tensor(a,numeric.dot(a,w)),g=b+1;g<=y;g++)for(p=h[g],x=M[g-b-1],_=0;_<r;_++)p[_]-=2*x[_]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(n,e){var t=numeric.toUpperHessenberg(n),i=numeric.QRFrancis(t.H,e),r=numeric.T,y=n.length,o,a,s=!1,u=i.B,f=numeric.dot(i.Q,numeric.dot(t.H,numeric.transpose(i.Q))),l=new r(numeric.dot(i.Q,t.Q)),c,m=u.length,d,h,p,v,w,M,x,g,b,_,E,R,F,P,D=Math.sqrt;for(a=0;a<m;a++)if(o=u[a][0],o!==u[a][1]){if(d=o+1,h=f[o][o],p=f[o][d],v=f[d][o],w=f[d][d],p===0&&v===0)continue;M=-h-w,x=h*w-p*v,g=M*M-4*x,g>=0?(M<0?b=-.5*(M-D(g)):b=-.5*(M+D(g)),F=(h-b)*(h-b)+p*p,P=v*v+(w-b)*(w-b),F>P?(F=D(F),E=(h-b)/F,R=p/F):(P=D(P),E=v/P,R=(w-b)/P),c=new r([[R,-E],[E,R]]),l.setRows(o,d,c.dot(l.getRows(o,d)))):(b=-.5*M,_=.5*D(-g),F=(h-b)*(h-b)+p*p,P=v*v+(w-b)*(w-b),F>P?(F=D(F+_*_),E=(h-b)/F,R=p/F,b=0,_/=F):(P=D(P+_*_),E=v/P,R=(w-b)/P,b=_/P,_=0),c=new r([[R,-E],[E,R]],[[b,_],[_,-b]]),l.setRows(o,d,c.dot(l.getRows(o,d))))}var I=l.dot(n).dot(l.transjugate()),y=n.length,O=numeric.T.identity(y);for(d=0;d<y;d++)if(d>0)for(a=d-1;a>=0;a--){var V=I.get([a,a]),N=I.get([d,d]);if(!numeric.neq(V.x,N.x)&&!numeric.neq(V.y,N.y)){O.setRow(d,O.getRow(a));continue}b=I.getRow(a).getBlock([a],[d-1]),_=O.getRow(d).getBlock([a],[d-1]),O.set([d,a],I.get([a,d]).neg().sub(b.dot(_)).div(V.sub(N)))}for(d=0;d<y;d++)b=O.getRow(d),O.setRow(d,b.div(b.norm2()));return O=O.transpose(),O=l.transjugate().dot(O),{lambda:I.getDiag(),E:O}},numeric.ccsSparse=function(n){var e=n.length,a,t,i,r,o=[];for(i=e-1;i!==-1;--i){t=n[i];for(r in t){for(r=parseInt(r);r>=o.length;)o[o.length]=0;t[r]!==0&&o[r]++}}var a=o.length,s=Array(a+1);for(s[0]=0,i=0;i<a;++i)s[i+1]=s[i]+o[i];var u=Array(s[a]),f=Array(s[a]);for(i=e-1;i!==-1;--i){t=n[i];for(r in t)t[r]!==0&&(o[r]--,u[s[r]+o[r]]=i,f[s[r]+o[r]]=t[r])}return[s,u,f]},numeric.ccsFull=function(n){var e=n[0],t=n[1],i=n[2],r=numeric.ccsDim(n),o=r[0],a=r[1],s,u,f,l,c,m=numeric.rep([o,a],0);for(s=0;s<a;s++)for(f=e[s],l=e[s+1],u=f;u<l;++u)m[t[u]][s]=i[u];return m},numeric.ccsTSolve=function(n,e,t,i,r){function o(b){var _;if(t[b]===0){for(t[b]=1,_=a[b];_<a[b+1];++_)o(s[_]);r[c]=b,++c}}var a=n[0],s=n[1],u=n[2],f=a.length-1,l=Math.max,c=0;typeof i>"u"&&(t=numeric.rep([f],0)),typeof i>"u"&&(i=numeric.linspace(0,t.length-1)),typeof r>"u"&&(r=[]);var m,d,h,p,v,w,M,x,g;for(m=i.length-1;m!==-1;--m)o(i[m]);for(r.length=c,m=r.length-1;m!==-1;--m)t[r[m]]=0;for(m=i.length-1;m!==-1;--m)d=i[m],t[d]=e[d];for(m=r.length-1;m!==-1;--m){for(d=r[m],h=a[d],p=l(a[d+1],h),v=h;v!==p;++v)if(s[v]===d){t[d]/=u[v];break}for(g=t[d],v=h;v!==p;++v)w=s[v],w!==d&&(t[w]-=g*u[v])}return t},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(n,e,t,i,r,o){var a=0,s,u=r.length,f=this.k,l=this.k1,c=this.j,m,d;if(i[n]===0)for(i[n]=1,c[0]=n,f[0]=m=e[n],l[0]=d=e[n+1];;)if(m>=d){if(r[u]=c[a],a===0)return;++u,--a,m=f[a],d=l[a]}else s=o[t[m]],i[s]===0?(i[s]=1,f[a]=m,++a,c[a]=s,m=e[s],l[a]=d=e[s+1]):++m},numeric.ccsLPSolve=function(n,e,t,i,r,o,a){var s=n[0],u=n[1],f=n[2],l=s.length-1,c=0,m=e[0],d=e[1],h=e[2],p,v,w,M,x,g,b,_,E,R,F,P;for(v=m[r],w=m[r+1],i.length=0,p=v;p<w;++p)a.dfs(o[d[p]],s,u,t,i,o);for(p=i.length-1;p!==-1;--p)t[i[p]]=0;for(p=v;p!==w;++p)M=o[d[p]],t[M]=h[p];for(p=i.length-1;p!==-1;--p){for(M=i[p],g=s[M],b=s[M+1],_=g;_<b;++_)if(o[u[_]]===M){t[M]/=f[_];break}for(P=t[M],_=g;_<b;++_)E=o[u[_]],E!==M&&(t[E]-=P*f[_])}return t},numeric.ccsLUP1=function(n,e){var t=n[0].length-1,i=[numeric.rep([t+1],0),[],[]],r=[numeric.rep([t+1],0),[],[]],o=i[0],a=i[1],s=i[2],u=r[0],f=r[1],l=r[2],c=numeric.rep([t],0),m=numeric.rep([t],0),d,h,p,v,w,M,x,g,b,_,E=numeric.ccsLPSolve,R=Math.max,F=Math.abs,P=numeric.linspace(0,t-1),D=numeric.linspace(0,t-1),I=new numeric.ccsDFS(t);for(typeof e>"u"&&(e=1),d=0;d<t;++d){for(E(i,n,c,m,d,D,I),M=-1,x=-1,h=m.length-1;h!==-1;--h)p=m[h],!(p<=d)&&(g=F(c[p]),g>M&&(x=p,M=g));for(F(c[d])<e*M&&(h=P[d],M=P[x],P[d]=M,D[M]=d,P[x]=h,D[h]=x,M=c[d],c[d]=c[x],c[x]=M),M=o[d],x=u[d],b=c[d],a[M]=P[d],s[M]=1,++M,h=m.length-1;h!==-1;--h)p=m[h],g=c[p],m[h]=0,c[p]=0,p<=d?(f[x]=p,l[x]=g,++x):(a[M]=P[p],s[M]=g/b,++M);o[d+1]=M,u[d+1]=x}for(h=a.length-1;h!==-1;--h)a[h]=D[a[h]];return{L:i,U:r,P,Pinv:D}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(n,e,t,i,r,o,a){var s=0,u,f=r.length,l=this.k,c=this.k1,m=this.j,d,h;if(i[n]===0)for(i[n]=1,m[0]=n,l[0]=d=e[o[n]],c[0]=h=e[o[n]+1];;){if(isNaN(d))throw new Error("Ow!");if(d>=h){if(r[f]=o[m[s]],s===0)return;++f,--s,d=l[s],h=c[s]}else u=t[d],i[u]===0?(i[u]=1,l[s]=d,++s,m[s]=u,u=o[u],d=e[u],c[s]=h=e[u+1]):++d}},numeric.ccsLPSolve0=function(n,e,t,i,r,o,a,s){var u=n[0],f=n[1],l=n[2],c=u.length-1,m=0,d=e[0],h=e[1],p=e[2],v,w,M,x,g,b,_,E,R,F,P,D;for(w=d[r],M=d[r+1],i.length=0,v=w;v<M;++v)s.dfs(h[v],u,f,t,i,o,a);for(v=i.length-1;v!==-1;--v)x=i[v],t[a[x]]=0;for(v=w;v!==M;++v)x=h[v],t[x]=p[v];for(v=i.length-1;v!==-1;--v){for(x=i[v],R=a[x],b=u[x],_=u[x+1],E=b;E<_;++E)if(f[E]===R){t[R]/=l[E];break}for(D=t[R],E=b;E<_;++E)t[f[E]]-=D*l[E];t[R]=D}},numeric.ccsLUP0=function(n,e){var t=n[0].length-1,i=[numeric.rep([t+1],0),[],[]],r=[numeric.rep([t+1],0),[],[]],o=i[0],a=i[1],s=i[2],u=r[0],f=r[1],l=r[2],c=numeric.rep([t],0),m=numeric.rep([t],0),d,h,p,v,w,M,x,g,b,_,E=numeric.ccsLPSolve0,R=Math.max,F=Math.abs,P=numeric.linspace(0,t-1),D=numeric.linspace(0,t-1),I=new numeric.ccsDFS0(t);for(typeof e>"u"&&(e=1),d=0;d<t;++d){for(E(i,n,c,m,d,D,P,I),M=-1,x=-1,h=m.length-1;h!==-1;--h)p=m[h],!(p<=d)&&(g=F(c[P[p]]),g>M&&(x=p,M=g));for(F(c[P[d]])<e*M&&(h=P[d],M=P[x],P[d]=M,D[M]=d,P[x]=h,D[h]=x),M=o[d],x=u[d],b=c[P[d]],a[M]=P[d],s[M]=1,++M,h=m.length-1;h!==-1;--h)p=m[h],g=c[P[p]],m[h]=0,c[P[p]]=0,p<=d?(f[x]=p,l[x]=g,++x):(a[M]=P[p],s[M]=g/b,++M);o[d+1]=M,u[d+1]=x}for(h=a.length-1;h!==-1;--h)a[h]=D[a[h]];return{L:i,U:r,P,Pinv:D}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(n){return[numeric.sup(n[1])+1,n[0].length-1]},numeric.ccsGetBlock=function(n,e,t){var i=numeric.ccsDim(n),r=i[0],o=i[1];typeof e>"u"?e=numeric.linspace(0,r-1):typeof e=="number"&&(e=[e]),typeof t>"u"?t=numeric.linspace(0,o-1):typeof t=="number"&&(t=[t]);var a,s,u,f=e.length,l,c=t.length,m,d,h,p=numeric.rep([o],0),v=[],w=[],M=[p,v,w],x=n[0],g=n[1],b=n[2],_=numeric.rep([r],0),E=0,R=numeric.rep([r],0);for(l=0;l<c;++l){d=t[l];var F=x[d],P=x[d+1];for(a=F;a<P;++a)m=g[a],R[m]=1,_[m]=b[a];for(a=0;a<f;++a)h=e[a],R[h]&&(v[E]=a,w[E]=_[e[a]],++E);for(a=F;a<P;++a)m=g[a],R[m]=0;p[l+1]=E}return M},numeric.ccsDot=function(n,e){var t=n[0],i=n[1],r=n[2],o=e[0],a=e[1],s=e[2],u=numeric.ccsDim(n),f=numeric.ccsDim(e),l=u[0],c=u[1],m=f[1],d=numeric.rep([l],0),h=numeric.rep([l],0),p=Array(l),v=numeric.rep([m],0),w=[],M=[],x=[v,w,M],g,b,_,E,R,F,P,D,I,y,O;for(_=0;_!==m;++_){for(E=o[_],R=o[_+1],I=0,b=E;b<R;++b)for(y=a[b],O=s[b],F=t[y],P=t[y+1],g=F;g<P;++g)D=i[g],h[D]===0&&(p[I]=D,h[D]=1,I+=1),d[D]=d[D]+r[g]*O;for(E=v[_],R=E+I,v[_+1]=R,b=I-1;b!==-1;--b)O=E+b,g=p[b],w[O]=g,M[O]=d[g],h[g]=0,d[g]=0;v[_+1]=v[_]+I}return x},numeric.ccsLUPSolve=function(n,e){var t=n.L,i=n.U,r=n.P,o=e[0],a=!1;typeof o!="object"&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],o=e[0],a=!0);var s=e[1],u=e[2],f=t[0].length-1,l=o.length-1,c=numeric.rep([f],0),m=Array(f),d=numeric.rep([f],0),h=Array(f),p=numeric.rep([l+1],0),v=[],w=[],M=numeric.ccsTSolve,x,g,b,_,E,R,F=0;for(x=0;x<l;++x){for(E=0,b=o[x],_=o[x+1],g=b;g<_;++g)R=n.Pinv[s[g]],h[E]=R,d[R]=u[g],++E;for(h.length=E,M(t,d,c,h,m),g=h.length-1;g!==-1;--g)d[h[g]]=0;if(M(i,c,d,m,h),a)return d;for(g=m.length-1;g!==-1;--g)c[m[g]]=0;for(g=h.length-1;g!==-1;--g)R=h[g],v[F]=R,w[F]=d[R],d[R]=0,++F;p[x+1]=F}return[p,v,w]},numeric.ccsbinop=function(n,e){return typeof e>"u"&&(e=""),Function("X","Y",`var Xi = X[0], Xj = X[1], Xv = X[2];
var Yi = Y[0], Yj = Y[1], Yv = Y[2];
var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;
var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];
var x = numeric.rep([m],0),y = numeric.rep([m],0);
var xk,yk,zk;
var i,j,j0,j1,k,p=0;
`+e+`for(i=0;i<n;++i) {
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Xj[j];
    x[k] = 1;
    Zj[p] = k;
    ++p;
  }
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Yj[j];
    y[k] = Yv[j];
    if(x[k] === 0) {
      Zj[p] = k;
      ++p;
    }
  }
  Zi[i+1] = p;
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];
  j0 = Zi[i]; j1 = Zi[i+1];
  for(j=j0;j!==j1;++j) {
    k = Zj[j];
    xk = x[k];
    yk = y[k];
`+n+`
    Zv[j] = zk;
  }
  j0 = Xi[i]; j1 = Xi[i+1];
  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;
  j0 = Yi[i]; j1 = Yi[i+1];
  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;
}
return [Zi,Zj,Zv];`)},(function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+`;
if(typeof Y === "number") return `+B+`;
return `+C+`;
`)})(),numeric.ccsScatter=function(n){var e=n[0],t=n[1],i=n[2],r=numeric.sup(t)+1,o=e.length,a=numeric.rep([r],0),s=Array(o),u=Array(o),f=numeric.rep([r],0),l;for(l=0;l<o;++l)f[t[l]]++;for(l=0;l<r;++l)a[l+1]=a[l]+f[l];var c=a.slice(0),m,d;for(l=0;l<o;++l)d=t[l],m=c[d],s[m]=e[l],u[m]=i[l],c[d]=c[d]+1;return[a,s,u]},numeric.ccsGather=function(n){var e=n[0],t=n[1],i=n[2],r=e.length-1,o=t.length,a=Array(o),s=Array(o),u=Array(o),f,l,c,m,d;for(d=0,f=0;f<r;++f)for(c=e[f],m=e[f+1],l=c;l!==m;++l)s[d]=f,a[d]=t[l],u[d]=i[l],++d;return[a,s,u]},numeric.sdim=function n(e,t,i){if(typeof t>"u"&&(t=[]),typeof e!="object")return t;typeof i>"u"&&(i=0),i in t||(t[i]=0),e.length>t[i]&&(t[i]=e.length);var r;for(r in e)e.hasOwnProperty(r)&&n(e[r],t,i+1);return t},numeric.sclone=function n(e,t,i){typeof t>"u"&&(t=0),typeof i>"u"&&(i=numeric.sdim(e).length);var r,o=Array(e.length);if(t===i-1){for(r in e)e.hasOwnProperty(r)&&(o[r]=e[r]);return o}for(r in e)e.hasOwnProperty(r)&&(o[r]=n(e[r],t+1,i));return o},numeric.sdiag=function(n){var e=n.length,t,i=Array(e),r,o,a;for(t=e-1;t>=1;t-=2)r=t-1,i[t]=[],i[t][t]=n[t],i[r]=[],i[r][r]=n[r];return t===0&&(i[0]=[],i[0][0]=n[t]),i},numeric.sidentity=function(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function(n){var e=[],t=n.length,i,r,o;for(i in n)if(n.hasOwnProperty(i)){o=n[i];for(r in o)o.hasOwnProperty(r)&&(typeof e[r]!="object"&&(e[r]=[]),e[r][i]=o[r])}return e},numeric.sLUP=function(n,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(n,e){var t=n.length,i=e.length,r=numeric.stranspose(e),o=r.length,a,s,u,f,l,c,m=Array(t),d;for(u=t-1;u>=0;u--){for(d=[],a=n[u],l=o-1;l>=0;l--){c=0,s=r[l];for(f in a)a.hasOwnProperty(f)&&f in s&&(c+=a[f]*s[f]);c&&(d[l]=c)}m[u]=d}return m},numeric.sdotMV=function(n,e){var t=n.length,i,r,o,a=Array(t),s;for(r=t-1;r>=0;r--){i=n[r],s=0;for(o in i)i.hasOwnProperty(o)&&e[o]&&(s+=i[o]*e[o]);s&&(a[r]=s)}return a},numeric.sdotVM=function(n,e){var t,i,r,o,a=[],s;for(t in n)if(n.hasOwnProperty(t)){r=e[t],o=n[t];for(i in r)r.hasOwnProperty(i)&&(a[i]||(a[i]=0),a[i]+=o*r[i])}return a},numeric.sdotVV=function(n,e){var t,i=0;for(t in n)n[t]&&e[t]&&(i+=n[t]*e[t]);return i},numeric.sdot=function(n,e){var t=numeric.sdim(n).length,i=numeric.sdim(e).length,r=t*1e3+i;switch(r){case 0:return n*e;case 1001:return numeric.sdotVV(n,e);case 2001:return numeric.sdotMV(n,e);case 1002:return numeric.sdotVM(n,e);case 2002:return numeric.sdotMM(n,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+t+" and "+i)}},numeric.sscatter=function(n){var e=n[0].length,t,i,r,o=n.length,a=[],s;for(i=e-1;i>=0;--i)if(n[o-1][i]){for(s=a,r=0;r<o-2;r++)t=n[r][i],s[t]||(s[t]=[]),s=s[t];s[n[r][i]]=n[r+1][i]}return a},numeric.sgather=function n(e,t,i){typeof t>"u"&&(t=[]),typeof i>"u"&&(i=[]);var r,o,a;r=i.length;for(o in e)if(e.hasOwnProperty(o))if(i[r]=parseInt(o),a=e[o],typeof a=="number"){if(a){if(t.length===0)for(o=r+1;o>=0;--o)t[o]=[];for(o=r;o>=0;--o)t[o].push(i[o]);t[r+1].push(a)}}else n(a,t,i);return i.length>r&&i.pop(),t},numeric.cLU=function(n){var e=n[0],t=n[1],i=n[2],R=e.length,r=0,o,a,s,u,f,l;for(o=0;o<R;o++)e[o]>r&&(r=e[o]);r++;var c=Array(r),m=Array(r),d=numeric.rep([r],1/0),h=numeric.rep([r],-1/0),M,x,p;for(s=0;s<R;s++)o=e[s],a=t[s],a<d[o]&&(d[o]=a),a>h[o]&&(h[o]=a);for(o=0;o<r-1;o++)h[o]>h[o+1]&&(h[o+1]=h[o]);for(o=r-1;o>=1;o--)d[o]<d[o-1]&&(d[o-1]=d[o]);var v=0,w=0;for(o=0;o<r;o++)m[o]=numeric.rep([h[o]-d[o]+1],0),c[o]=numeric.rep([o-d[o]],0),v+=o-d[o]+1,w+=h[o]-o+1;for(s=0;s<R;s++)o=e[s],m[o][t[s]-d[o]]=i[s];for(o=0;o<r-1;o++)for(u=o-d[o],M=m[o],a=o+1;d[a]<=o&&a<r;a++)if(f=o-d[a],l=h[o]-o,x=m[a],p=x[f]/M[u],p){for(s=1;s<=l;s++)x[s+f]-=p*M[s+u];c[a][o-d[a]]=p}var M=[],x=[],g=[],b=[],_=[],E=[],R,F,P;for(R=0,F=0,o=0;o<r;o++){for(u=d[o],f=h[o],P=m[o],a=o;a<=f;a++)P[a-u]&&(M[R]=o,x[R]=a,g[R]=P[a-u],R++);for(P=c[o],a=u;a<o;a++)P[a-u]&&(b[F]=o,_[F]=a,E[F]=P[a-u],F++);b[F]=o,_[F]=o,E[F]=1,F++}return{U:[M,x,g],L:[b,_,E]}},numeric.cLUsolve=function(n,e){var t=n.L,i=n.U,r=numeric.clone(e),o=t[0],a=t[1],s=t[2],u=i[0],f=i[1],l=i[2],c=u.length,m=o.length,d=r.length,h,p,v;for(v=0,h=0;h<d;h++){for(;a[v]<h;)r[h]-=s[v]*r[a[v]],v++;v++}for(v=c-1,h=d-1;h>=0;h--){for(;f[v]>h;)r[h]-=l[v]*r[f[v]],v--;r[h]/=l[v],v--}return r},numeric.cgrid=function(n,e){typeof n=="number"&&(n=[n,n]);var t=numeric.rep(n,-1),i,r,o;if(typeof e!="function")switch(e){case"L":e=function(a,s){return a>=n[0]/2||s<n[1]/2};break;default:e=function(a,s){return!0}}for(o=0,i=1;i<n[0]-1;i++)for(r=1;r<n[1]-1;r++)e(i,r)&&(t[i][r]=o,o++);return t},numeric.cdelsq=function(n){var e=[[-1,0],[0,-1],[0,1],[1,0]],t=numeric.dim(n),i=t[0],r=t[1],o,a,s,u,f,l=[],c=[],m=[];for(o=1;o<i-1;o++)for(a=1;a<r-1;a++)if(!(n[o][a]<0)){for(s=0;s<4;s++)u=o+e[s][0],f=a+e[s][1],!(n[u][f]<0)&&(l.push(n[o][a]),c.push(n[u][f]),m.push(-1));l.push(n[o][a]),c.push(n[o][a]),m.push(4)}return[l,c,m]},numeric.cdotMV=function(n,e){var t,i=n[0],r=n[1],o=n[2],a,s=i.length,u;for(u=0,a=0;a<s;a++)i[a]>u&&(u=i[a]);for(u++,t=numeric.rep([u],0),a=0;a<s;a++)t[i[a]]+=o[a]*e[r[a]];return t},numeric.Spline=function(n,e,t,i,r){this.x=n,this.yl=e,this.yr=t,this.kl=i,this.kr=r},numeric.Spline.prototype._at=function(s,e){var t=this.x,i=this.yl,r=this.yr,o=this.kl,a=this.kr,s,u,f,l,c=numeric.add,m=numeric.sub,d=numeric.mul;u=m(d(o[e],t[e+1]-t[e]),m(r[e+1],i[e])),f=c(d(a[e+1],t[e]-t[e+1]),m(r[e+1],i[e])),l=(s-t[e])/(t[e+1]-t[e]);var h=l*(1-l);return c(c(c(d(1-l,i[e]),d(l,r[e+1])),d(u,h*(1-l))),d(f,h*l))},numeric.Spline.prototype.at=function(n){if(typeof n=="number"){var e=this.x,f=e.length,t,i,r,o=Math.floor,a,s,u;for(t=0,i=f-1;i-t>1;)r=o((t+i)/2),e[r]<=n?t=r:i=r;return this._at(n,t)}var f=n.length,l,c=Array(f);for(l=f-1;l!==-1;--l)c[l]=this.at(n[l]);return c},numeric.Spline.prototype.diff=function(){var n=this.x,e=this.yl,t=this.yr,i=this.kl,r=this.kr,o=e.length,a,s,u,f=i,l=r,c=Array(o),m=Array(o),d=numeric.add,h=numeric.mul,p=numeric.div,v=numeric.sub;for(a=o-1;a!==-1;--a)s=n[a+1]-n[a],u=v(t[a+1],e[a]),c[a]=p(d(h(u,6),h(i[a],-4*s),h(r[a+1],-2*s)),s*s),m[a+1]=p(d(h(u,-6),h(i[a],2*s),h(r[a+1],4*s)),s*s);return new numeric.Spline(n,f,l,c,m)},numeric.Spline.prototype.roots=function(){function n($){return $*$}function e($,G,Y,le,q){var j=Y*2-(G-$),ne=-le*2+(G-$),W=(q+1)*.5,z=W*(1-W);return(1-W)*$+W*G+j*z*(1-W)+ne*z*W}var x=[],t=this.x,i=this.yl,r=this.yr,o=this.kl,a=this.kr;typeof i[0]=="number"&&(i=[i],r=[r],o=[o],a=[a]);var s=i.length,u=t.length-1,f,l,c,m,d,h,p,v,w,M,x=Array(s),g,b,_,E,R,F,P,D,I,y,O,V,N,ee,H,X,K,se=Math.sqrt;for(f=0;f!==s;++f){for(p=i[f],v=r[f],w=o[f],M=a[f],g=[],l=0;l!==u;l++){for(l>0&&v[l]*p[l]<0&&g.push(t[l]),I=t[l+1]-t[l],y=t[l],E=p[l],R=v[l+1],b=w[l]/I,_=M[l+1]/I,D=n(b-_+3*(E-R))+12*_*E,F=_+3*E+2*b-3*R,P=3*(_+b+2*(E-R)),D<=0?(V=F/P,V>t[l]&&V<t[l+1]?O=[t[l],V,t[l+1]]:O=[t[l],t[l+1]]):(V=(F-se(D))/P,N=(F+se(D))/P,O=[t[l]],V>t[l]&&V<t[l+1]&&O.push(V),N>t[l]&&N<t[l+1]&&O.push(N),O.push(t[l+1])),H=O[0],V=this._at(H,l),c=0;c<O.length-1;c++){if(X=O[c+1],N=this._at(X,l),V===0){g.push(H),H=X,V=N;continue}if(N===0||V*N>0){H=X,V=N;continue}for(var Z=0;K=(V*X-N*H)/(V-N),!(K<=H||K>=X);)if(ee=this._at(K,l),ee*N>0)X=K,N=ee,Z===-1&&(V*=.5),Z=-1;else{if(!(ee*V>0))break;H=K,V=ee,Z===1&&(N*=.5),Z=1}g.push(K),H=O[c+1],V=this._at(H,l)}N===0&&g.push(X)}x[f]=g}return typeof this.yl[0]=="number"?x[0]:x},numeric.spline=function(n,e,t,i){var r=n.length,o=[],a=[],s=[],u,f=numeric.sub,l=numeric.mul,c=numeric.add;for(u=r-2;u>=0;u--)a[u]=n[u+1]-n[u],s[u]=f(e[u+1],e[u]);(typeof t=="string"||typeof i=="string")&&(t=i="periodic");var m=[[],[],[]];switch(typeof t){case"undefined":o[0]=l(3/(a[0]*a[0]),s[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/a[0],1/a[0]);break;case"string":o[0]=c(l(3/(a[r-2]*a[r-2]),s[r-2]),l(3/(a[0]*a[0]),s[0])),m[0].push(0,0,0),m[1].push(r-2,0,1),m[2].push(1/a[r-2],2/a[r-2]+2/a[0],1/a[0]);break;default:o[0]=t,m[0].push(0),m[1].push(0),m[2].push(1)}for(u=1;u<r-1;u++)o[u]=c(l(3/(a[u-1]*a[u-1]),s[u-1]),l(3/(a[u]*a[u]),s[u])),m[0].push(u,u,u),m[1].push(u-1,u,u+1),m[2].push(1/a[u-1],2/a[u-1]+2/a[u],1/a[u]);switch(typeof i){case"undefined":o[r-1]=l(3/(a[r-2]*a[r-2]),s[r-2]),m[0].push(r-1,r-1),m[1].push(r-2,r-1),m[2].push(1/a[r-2],2/a[r-2]);break;case"string":m[1][m[1].length-1]=0;break;default:o[r-1]=i,m[0].push(r-1),m[1].push(r-1),m[2].push(1)}typeof o[0]!="number"?o=numeric.transpose(o):o=[o];var d=Array(o.length);if(typeof t=="string")for(u=d.length-1;u!==-1;--u)d[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),o[u]),d[u][r-1]=d[u][0];else for(u=d.length-1;u!==-1;--u)d[u]=numeric.cLUsolve(numeric.cLU(m),o[u]);return typeof e[0]=="number"?d=d[0]:d=numeric.transpose(d),new numeric.Spline(n,e,e,d,d)},numeric.fftpow2=function n(e,t){var i=e.length;if(i!==1){var r=Math.cos,o=Math.sin,a,s,u=Array(i/2),f=Array(i/2),l=Array(i/2),c=Array(i/2);for(s=i/2,a=i-1;a!==-1;--a)--s,l[s]=e[a],c[s]=t[a],--a,u[s]=e[a],f[s]=t[a];n(u,f),n(l,c),s=i/2;var m,d=-6.283185307179586/i,h,p;for(a=i-1;a!==-1;--a)--s,s===-1&&(s=i/2-1),m=d*a,h=r(m),p=o(m),e[a]=u[s]+h*l[s]-p*c[s],t[a]=f[s]+h*c[s]+p*l[s]}},numeric._ifftpow2=function n(e,t){var i=e.length;if(i!==1){var r=Math.cos,o=Math.sin,a,s,u=Array(i/2),f=Array(i/2),l=Array(i/2),c=Array(i/2);for(s=i/2,a=i-1;a!==-1;--a)--s,l[s]=e[a],c[s]=t[a],--a,u[s]=e[a],f[s]=t[a];n(u,f),n(l,c),s=i/2;var m,d=6.283185307179586/i,h,p;for(a=i-1;a!==-1;--a)--s,s===-1&&(s=i/2-1),m=d*a,h=r(m),p=o(m),e[a]=u[s]+h*l[s]-p*c[s],t[a]=f[s]+h*c[s]+p*l[s]}},numeric.ifftpow2=function(n,e){numeric._ifftpow2(n,e),numeric.diveq(n,n.length),numeric.diveq(e,e.length)},numeric.convpow2=function(n,e,t,i){numeric.fftpow2(n,e),numeric.fftpow2(t,i);var r,o=n.length,a,s,u,f;for(r=o-1;r!==-1;--r)a=n[r],u=e[r],s=t[r],f=i[r],n[r]=a*s-u*f,e[r]=a*f+u*s;numeric.ifftpow2(n,e)},numeric.T.prototype.fft=function(){var n=this.x,e=this.y,t=n.length,i=Math.log,r=i(2),o=Math.ceil(i(2*t-1)/r),a=Math.pow(2,o),s=numeric.rep([a],0),u=numeric.rep([a],0),f=Math.cos,l=Math.sin,c,m=-3.141592653589793/t,d,h=numeric.rep([a],0),p=numeric.rep([a],0),v=Math.floor(t/2);for(c=0;c<t;c++)h[c]=n[c];if(typeof e<"u")for(c=0;c<t;c++)p[c]=e[c];for(s[0]=1,c=1;c<=a/2;c++)d=m*c*c,s[c]=f(d),u[c]=l(d),s[a-c]=f(d),u[a-c]=l(d);var w=new numeric.T(h,p),M=new numeric.T(s,u);return w=w.mul(M),numeric.convpow2(w.x,w.y,numeric.clone(M.x),numeric.neg(M.y)),w=w.mul(M),w.x.length=t,w.y.length=t,w},numeric.T.prototype.ifft=function(){var n=this.x,e=this.y,t=n.length,i=Math.log,r=i(2),o=Math.ceil(i(2*t-1)/r),a=Math.pow(2,o),s=numeric.rep([a],0),u=numeric.rep([a],0),f=Math.cos,l=Math.sin,c,m=3.141592653589793/t,d,h=numeric.rep([a],0),p=numeric.rep([a],0),v=Math.floor(t/2);for(c=0;c<t;c++)h[c]=n[c];if(typeof e<"u")for(c=0;c<t;c++)p[c]=e[c];for(s[0]=1,c=1;c<=a/2;c++)d=m*c*c,s[c]=f(d),u[c]=l(d),s[a-c]=f(d),u[a-c]=l(d);var w=new numeric.T(h,p),M=new numeric.T(s,u);return w=w.mul(M),numeric.convpow2(w.x,w.y,numeric.clone(M.x),numeric.neg(M.y)),w=w.mul(M),w.x.length=t,w.y.length=t,w.div(t)},numeric.gradient=function(n,e){var t=e.length,i=n(e);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var d=Math.max,r,o=numeric.clone(e),a,s,u=Array(t),f=numeric.div,l=numeric.sub,c,m,d=Math.max,h=.001,p=Math.abs,v=Math.min,w,M,x,g=0,b,_,E;for(r=0;r<t;r++)for(var R=d(1e-6*i,1e-8);;){if(++g,g>20)throw new Error("Numerical gradient fails");if(o[r]=e[r]+R,a=n(o),o[r]=e[r]-R,s=n(o),o[r]=e[r],isNaN(a)||isNaN(s)){R/=16;continue}if(u[r]=(a-s)/(2*R),w=e[r]-R,M=e[r],x=e[r]+R,b=(a-i)/R,_=(i-s)/R,E=d(p(u[r]),p(i),p(a),p(s),p(w),p(M),p(x),1e-8),c=v(d(p(b-u[r]),p(_-u[r]),p(b-_))/E,R/E),!(c>h))break;R/=16}return u},numeric.uncmin=function(n,e,t,i,r,o,a){var s=numeric.gradient;typeof a>"u"&&(a={}),typeof t>"u"&&(t=1e-8),typeof i>"u"&&(i=function(le){return s(n,le)}),typeof r>"u"&&(r=1e3),e=numeric.clone(e);var u=e.length,f=n(e),l,c;if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,d=numeric.norm2;t=m(t,numeric.epsilon);var h,p,v,w=a.Hinv||numeric.identity(u),M=numeric.dot,x=numeric.inv,g=numeric.sub,b=numeric.add,_=numeric.tensor,E=numeric.div,R=numeric.mul,F=numeric.all,P=numeric.isFinite,D=numeric.neg,I=0,y,O,V,N,ee,H,X,K,se,Z,$,G,Y="";for(p=i(e);I<r;){if(typeof o=="function"&&o(I,e,f,p,w)){Y="Callback returned true";break}if(!F(P(p))){Y="Gradient has Infinity or NaN";break}if(h=D(M(w,p)),!F(P(h))){Y="Search direction has Infinity or NaN";break}if(Z=d(h),Z<t){Y="Newton step smaller than tol";break}for(se=1,c=M(p,h),V=e;I<r&&!(se*Z<t);){if(O=R(h,se),V=b(e,O),l=n(V),l-f>=.1*se*c||isNaN(l)){se*=.5,++I;continue}break}if(se*Z<t){Y="Line search step size smaller than tol";break}if(I===r){Y="maxit reached during line search";break}v=i(V),N=g(v,p),X=M(N,O),ee=M(w,N),w=g(b(w,R((X+M(N,ee))/(X*X),_(O,O))),E(b(_(ee,O),_(O,ee)),X)),e=V,f=l,p=v,++I}return{solution:e,f,gradient:p,invHessian:w,iterations:I,message:Y}},numeric.Dopri=function(n,e,t,i,r,o,a){this.x=n,this.y=e,this.f=t,this.ymid=i,this.iterations=r,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(p,e){function t(F){return F*F}var i=this,r=i.x,o=i.y,a=i.f,s=i.ymid,u=r.length,f,l,c,m,d,h,p,v=Math.floor,w,M=.5,x=numeric.add,g=numeric.mul,b=numeric.sub,_,E,R;return f=r[e],l=r[e+1],m=o[e],d=o[e+1],w=l-f,c=f+M*w,h=s[e],_=b(a[e],g(m,1/(f-c)+2/(f-l))),E=b(a[e+1],g(d,1/(l-c)+2/(l-f))),R=[t(p-l)*(p-c)/t(f-l)/(f-c),t(p-f)*t(p-l)/t(f-c)/t(l-c),t(p-f)*(p-c)/t(l-f)/(l-c),(p-f)*t(p-l)*(p-c)/t(f-l)/(f-c),(p-l)*t(p-f)*(p-c)/t(f-l)/(l-c)],x(x(x(x(g(m,R[0]),g(h,R[1])),g(d,R[2])),g(_,R[3])),g(E,R[4]))},numeric.Dopri.prototype.at=function(n){var e,t,i,r=Math.floor;if(typeof n!="number"){var o=n.length,a=Array(o);for(e=o-1;e!==-1;--e)a[e]=this.at(n[e]);return a}var s=this.x;for(e=0,t=s.length-1;t-e>1;)i=r(.5*(e+t)),s[i]<=n?e=i:t=i;return this._at(n,e)},numeric.dopri=function(n,e,t,i,r,o,a){typeof r>"u"&&(r=1e-6),typeof o>"u"&&(o=1e3);var s=[n],u=[t],f=[i(n,t)],l,c,m,d,h,p,v=[],w=.2,M=[.075,.225],x=[44/45,-56/15,32/9],g=[19372/6561,-25360/2187,64448/6561,-212/729],b=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],_=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],R=[.2,.3,.8,8/9,1,1],F=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],P=0,D,I,y=(e-n)/10,O=0,V=numeric.add,N=numeric.mul,ee,H,X=Math.max,K=Math.min,se=Math.abs,Z=numeric.norminf,$=Math.pow,G=numeric.any,Y=numeric.lt,le=numeric.and,q=numeric.sub,j,ne,W,z=new numeric.Dopri(s,u,f,v,-1,"");for(typeof a=="function"&&(j=a(n,t));n<e&&O<o;){if(++O,n+y>e&&(y=e-n),l=i(n+R[0]*y,V(t,N(w*y,f[P]))),c=i(n+R[1]*y,V(V(t,N(M[0]*y,f[P])),N(M[1]*y,l))),m=i(n+R[2]*y,V(V(V(t,N(x[0]*y,f[P])),N(x[1]*y,l)),N(x[2]*y,c))),d=i(n+R[3]*y,V(V(V(V(t,N(g[0]*y,f[P])),N(g[1]*y,l)),N(g[2]*y,c)),N(g[3]*y,m))),h=i(n+R[4]*y,V(V(V(V(V(t,N(b[0]*y,f[P])),N(b[1]*y,l)),N(b[2]*y,c)),N(b[3]*y,m)),N(b[4]*y,d))),ee=V(V(V(V(V(t,N(f[P],y*_[0])),N(c,y*_[2])),N(m,y*_[3])),N(d,y*_[4])),N(h,y*_[5])),p=i(n+y,ee),D=V(V(V(V(V(N(f[P],y*F[0]),N(c,y*F[2])),N(m,y*F[3])),N(d,y*F[4])),N(h,y*F[5])),N(p,y*F[6])),typeof D=="number"?H=se(D):H=Z(D),H>r){if(y=.2*y*$(r/H,.25),n+y===n){z.msg="Step size became too small";break}continue}if(v[P]=V(V(V(V(V(V(t,N(f[P],y*E[0])),N(c,y*E[2])),N(m,y*E[3])),N(d,y*E[4])),N(h,y*E[5])),N(p,y*E[6])),++P,s[P]=n+y,u[P]=ee,f[P]=p,typeof a=="function"){var Q,de=n,oe=n+.5*y,ae;if(ne=a(oe,v[P-1]),W=le(Y(j,0),Y(0,ne)),G(W)||(de=oe,oe=n+y,j=ne,ne=a(oe,ee),W=le(Y(j,0),Y(0,ne))),G(W)){for(var pe,Ke,Oe,he,Ue=0,Me=1,Ee=1;;){if(typeof j=="number")ae=(Ee*ne*de-Me*j*oe)/(Ee*ne-Me*j);else for(ae=oe,I=j.length-1;I!==-1;--I)j[I]<0&&ne[I]>0&&(ae=K(ae,(Ee*ne[I]*de-Me*j[I]*oe)/(Ee*ne[I]-Me*j[I])));if(ae<=de||ae>=oe)break;Q=z._at(ae,P-1),he=a(ae,Q),Oe=le(Y(j,0),Y(0,he)),G(Oe)?(oe=ae,ne=he,W=Oe,Ee=1,Ue===-1?Me*=.5:Me=1,Ue=-1):(de=ae,j=he,Me=1,Ue===1?Ee*=.5:Ee=1,Ue=1)}return ee=z._at(.5*(n+ae),P-1),z.f[P]=i(ae,Q),z.x[P]=ae,z.y[P]=Q,z.ymid[P-1]=ee,z.events=W,z.iterations=O,z}}n+=y,t=ee,j=ne,y=K(.8*y*$(r/H,.25),4*y)}return z.iterations=O,z},numeric.LU=function(n,e){e=e||!1;var t=Math.abs,i,r,o,a,s,u,f,l,c,m=n.length,d=m-1,h=new Array(m);for(e||(n=numeric.clone(n)),o=0;o<m;++o){for(f=o,u=n[o],c=t(u[o]),r=o+1;r<m;++r)a=t(n[r][o]),c<a&&(c=a,f=r);for(h[o]=f,f!=o&&(n[o]=n[f],n[f]=u,u=n[o]),s=u[o],i=o+1;i<m;++i)n[i][o]/=s;for(i=o+1;i<m;++i){for(l=n[i],r=o+1;r<d;++r)l[r]-=l[o]*u[r],++r,l[r]-=l[o]*u[r];r===d&&(l[r]-=l[o]*u[r])}}return{LU:n,P:h}},numeric.LUsolve=function(n,e){var t,i,r=n.LU,o=r.length,a=numeric.clone(e),s=n.P,u,f,l,c;for(t=o-1;t!==-1;--t)a[t]=e[t];for(t=0;t<o;++t)for(u=s[t],s[t]!==t&&(c=a[t],a[t]=a[u],a[u]=c),f=r[t],i=0;i<t;++i)a[t]-=a[i]*f[i];for(t=o-1;t>=0;--t){for(f=r[t],i=t+1;i<o;++i)a[t]-=a[i]*f[i];a[t]/=f[t]}return a},numeric.solve=function(n,e,t){return numeric.LUsolve(numeric.LU(n,t),e)},numeric.echelonize=function(n){var e=numeric.dim(n),t=e[0],i=e[1],r=numeric.identity(t),o=Array(t),a,s,u,f,l,c,m,d,h=Math.abs,p=numeric.diveq;for(n=numeric.clone(n),a=0;a<t;++a){for(u=0,l=n[a],c=r[a],s=1;s<i;++s)h(l[u])<h(l[s])&&(u=s);for(o[a]=u,p(c,l[u]),p(l,l[u]),s=0;s<t;++s)if(s!==a){for(m=n[s],d=m[u],f=i-1;f!==-1;--f)m[f]-=l[f]*d;for(m=r[s],f=t-1;f!==-1;--f)m[f]-=c[f]*d}}return{I:r,A:n,P:o}},numeric.__solveLP=function(n,e,t,i,r,o,a){var s=numeric.sum,u=numeric.log,f=numeric.mul,l=numeric.sub,c=numeric.dot,m=numeric.div,d=numeric.add,h=n.length,p=t.length,v,w=!1,M,x=0,g=1,b,_,E=numeric.transpose(e),R=numeric.svd,F=numeric.transpose,P=numeric.leq,D=Math.sqrt,I=Math.abs,y=numeric.muleq,O=numeric.norminf,V=numeric.any,N=Math.min,ee=numeric.all,H=numeric.gt,X=Array(h),K=Array(p),se=numeric.rep([p],1),Z,$=numeric.solve,G=l(t,c(e,o)),Y,le=c(n,n),q;for(Y=x;Y<r;++Y){var j,ne,W;for(j=p-1;j!==-1;--j)K[j]=m(e[j],G[j]);var z=F(K);for(j=h-1;j!==-1;--j)X[j]=s(z[j]);g=.25*I(le/c(n,X));var Q=100*D(le/c(X,X));for((!isFinite(g)||g>Q)&&(g=Q),q=d(n,f(g,X)),Z=c(z,K),j=h-1;j!==-1;--j)Z[j][j]+=1;W=$(Z,m(q,g),!0);var de=m(G,c(e,W)),oe=1;for(j=p-1;j!==-1;--j)de[j]<0&&(oe=N(oe,-.999*de[j]));if(v=l(o,f(W,oe)),G=l(t,c(e,v)),!ee(H(G,0)))return{solution:o,message:"",iterations:Y};if(o=v,g<i)return{solution:v,message:"",iterations:Y};if(a){var ae=c(n,q),pe=c(e,q);for(w=!0,j=p-1;j!==-1;--j)if(ae*pe[j]<0){w=!1;break}}else o[h-1]>=0?w=!1:w=!0;if(w)return{solution:v,message:"Unbounded",iterations:Y}}return{solution:o,message:"maximum iteration count exceeded",iterations:Y}},numeric._solveLP=function(n,e,t,i,r){var o=n.length,a=t.length,M,s=numeric.sum,u=numeric.log,f=numeric.mul,l=numeric.sub,c=numeric.dot,m=numeric.div,d=numeric.add,h=numeric.rep([o],0).concat([1]),p=numeric.rep([a,1],-1),v=numeric.blockMatrix([[e,p]]),w=t,M=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(t)))+1),x=numeric.__solveLP(h,v,w,i,r,M,!1),g=numeric.clone(x.solution);g.length=o;var b=numeric.inf(l(t,c(e,g)));if(b<0)return{solution:NaN,message:"Infeasible",iterations:x.iterations};var _=numeric.__solveLP(n,e,t,i,r-x.iterations,g,!0);return _.iterations+=x.iterations,_},numeric.solveLP=function(n,e,t,i,r,o,a){if(typeof a>"u"&&(a=1e3),typeof o>"u"&&(o=numeric.epsilon),typeof i>"u")return numeric._solveLP(n,e,t,o,a);var s=i.length,u=i[0].length,f=e.length,l=numeric.echelonize(i),c=numeric.rep([u],0),m=l.P,d=[],h;for(h=m.length-1;h!==-1;--h)c[m[h]]=1;for(h=u-1;h!==-1;--h)c[h]===0&&d.push(h);var p=numeric.getRange,v=numeric.linspace(0,s-1),w=numeric.linspace(0,f-1),M=p(i,v,d),x=p(e,w,m),g=p(e,w,d),b=numeric.dot,_=numeric.sub,E=b(x,l.I),R=_(g,b(E,M)),F=_(t,b(E,r)),P=Array(m.length),D=Array(d.length);for(h=m.length-1;h!==-1;--h)P[h]=n[m[h]];for(h=d.length-1;h!==-1;--h)D[h]=n[d[h]];var I=_(D,b(P,b(l.I,M))),y=numeric._solveLP(I,R,F,o,a),O=y.solution;if(O!==O)return y;var V=b(l.I,_(r,b(M,O))),N=Array(n.length);for(h=m.length-1;h!==-1;--h)N[m[h]]=V[h];for(h=d.length-1;h!==-1;--h)N[d[h]]=O[h];return{solution:N,message:y.message,iterations:y.iterations}},numeric.MPStoLP=function(n){function e(_){throw new Error("MPStoLP: "+_+`
Line `+o+": "+n[o]+`
Current state: `+i[t]+`
`)}n instanceof String&&n.split(`
`);var t=0,i=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],r=n.length,o,a,s,u=0,f={},l=[],c=0,m={},d=0,h,p=[],v=[],w=[];for(o=0;o<r;++o){s=n[o];var M=s.match(/\S*/g),x=[];for(a=0;a<M.length;++a)M[a]!==""&&x.push(M[a]);if(x.length!==0){for(a=0;a<i.length&&s.substr(0,i[a].length)!==i[a];++a);if(a<i.length){if(t=a,a===1&&(h=x[1]),a===6)return{name:h,c:p,A:numeric.transpose(v),b:w,rows:f,vars:m};continue}switch(t){case 0:case 1:e("Unexpected line");case 2:switch(x[0]){case"N":u===0?u=x[1]:e("Two or more N rows");break;case"L":f[x[1]]=c,l[c]=1,w[c]=0,++c;break;case"G":f[x[1]]=c,l[c]=-1,w[c]=0,++c;break;case"E":f[x[1]]=c,l[c]=0,w[c]=0,++c;break;default:e("Parse error "+numeric.prettyPrint(x))}break;case 3:m.hasOwnProperty(x[0])||(m[x[0]]=d,p[d]=0,v[d]=numeric.rep([c],0),++d);var g=m[x[0]];for(a=1;a<x.length;a+=2){if(x[a]===u){p[g]=parseFloat(x[a+1]);continue}var b=f[x[a]];v[g][b]=(l[b]<0?-1:1)*parseFloat(x[a+1])}break;case 4:for(a=1;a<x.length;a+=2)w[f[x[a]]]=(l[f[x[a]]]<0?-1:1)*parseFloat(x[a+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},(function(n,e,t,i,r,o,a){function s(c){var m,d,h=this,p=c.length,v=0,w=h.i=h.j=h.m=0;for(h.S=[],h.c=[],p||(c=[p++]);v<t;)h.S[v]=v++;for(v=0;v<t;v++)m=h.S[v],w=l(w+m+c[v%p]),d=h.S[w],h.S[v]=d,h.S[w]=m;h.g=function(M){var x=h.S,g=l(h.i+1),b=x[g],_=l(h.j+b),E=x[_];x[g]=E,x[_]=b;for(var R=x[l(b+E)];--M;)g=l(g+1),b=x[g],_=l(_+b),E=x[_],x[g]=E,x[_]=b,R=R*t+x[l(b+E)];return h.i=g,h.j=_,R},h.g(t)}function u(c,m,d,h,p){if(d=[],p=typeof c,m&&p=="object"){for(h in c)if(h.indexOf("S")<5)try{d.push(u(c[h],m-1))}catch{}}return d.length?d:c+(p!="string"?"\0":"")}function f(c,m,d,h){for(c+="",d=0,h=0;h<c.length;h++)m[l(h)]=l((d^=m[l(h)]*19)+c.charCodeAt(h));c="";for(h in m)c+=String.fromCharCode(m[h]);return c}function l(c){return c&t-1}e.seedrandom=function(c,m){var d=[],h;return c=f(u(m?[c,n]:arguments.length?c:[new Date().getTime(),n,window],3),d),h=new s(d),f(h.S,n),e.random=function(){for(var p=h.g(i),v=a,w=0;p<r;)p=(p+w)*t,v*=t,w=h.g(1);for(;p>=o;)p/=2,v/=2,w>>>=1;return(p+w)/v},c},a=e.pow(t,i),r=e.pow(2,r),o=r*2,f(e.random(),n)})([],numeric.seedrandom,256,6,52),(function(n){function e(u){if(typeof u!="object")return u;var f=[],l,c=u.length;for(l=0;l<c;l++)f[l+1]=e(u[l]);return f}function t(u){if(typeof u!="object")return u;var f=[],l,c=u.length;for(l=1;l<c;l++)f[l-1]=t(u[l]);return f}function i(u,f,l){var c,m,d,h,p;for(d=1;d<=l;d+=1){for(u[d][d]=1/u[d][d],p=-u[d][d],c=1;c<d;c+=1)u[c][d]=p*u[c][d];if(h=d+1,l<h)break;for(m=h;m<=l;m+=1)for(p=u[d][m],u[d][m]=0,c=1;c<=d;c+=1)u[c][m]=u[c][m]+p*u[c][d]}}function r(u,f,l,c){var m,d,h,p;for(d=1;d<=l;d+=1){for(p=0,m=1;m<d;m+=1)p+=u[m][d]*c[m];c[d]=(c[d]-p)/u[d][d]}for(h=1;h<=l;h+=1)for(d=l+1-h,c[d]=c[d]/u[d][d],p=-c[d],m=1;m<d;m+=1)c[m]=c[m]+p*u[m][d]}function o(u,f,l,c){var m,d,h,p,v,w;for(d=1;d<=l;d+=1){if(c[1]=d,w=0,h=d-1,h<1){if(w=u[d][d]-w,w<=0)break;u[d][d]=Math.sqrt(w)}else{for(p=1;p<=h;p+=1){for(v=u[p][d],m=1;m<p;m+=1)v-=u[m][d]*u[m][p];v/=u[p][p],u[p][d]=v,w+=v*v}if(w=u[d][d]-w,w<=0)break;u[d][d]=Math.sqrt(w)}c[1]=0}}function a(u,f,l,c,m,d,h,p,v,w,M,x,g,b,_,E){function R(){for(b[1]=b[1]+1,V=Z,y=1;y<=w;y+=1){for(V+=1,j=-p[y],O=1;O<=c;O+=1)j+=h[O][y]*m[O];if(Math.abs(j)<pe&&(j=0),y>M)_[V]=j;else if(_[V]=-Math.abs(j),j>0){for(O=1;O<=c;O+=1)h[O][y]=-h[O][y];p[y]=-p[y]}}for(y=1;y<=g;y+=1)_[Z+x[y]]=0;for(G=0,q=0,y=1;y<=w;y+=1)_[Z+y]<q*_[le+y]&&(G=y,q=_[Z+y]/_[le+y]);return G===0?999:0}function F(){for(y=1;y<=c;y+=1){for(j=0,O=1;O<=c;O+=1)j+=u[O][y]*h[O][G];_[y]=j}for(N=X,y=1;y<=c;y+=1)_[N+y]=0;for(O=g+1;O<=c;O+=1)for(y=1;y<=c;y+=1)_[N+y]=_[N+y]+u[y][O]*_[O];for(oe=!0,y=g;y>=1;y-=1){for(j=_[y],V=se+y*(y+3)/2,N=V-y,O=y+1;O<=g;O+=1)j-=_[V]*_[K+O],V+=O;if(j/=_[N],_[K+y]=j,x[y]<M||j<0)break;oe=!1,H=y}if(!oe)for(ne=_[$+H]/_[K+H],y=1;y<=g&&!(x[y]<M||_[K+y]<0);y+=1)q=_[$+y]/_[K+y],q<ne&&(ne=q,H=y);for(j=0,y=X+1;y<=X+c;y+=1)j+=_[y]*_[y];if(Math.abs(j)<=pe){if(oe)return E[1]=1,999;for(y=1;y<=g;y+=1)_[$+y]=_[$+y]-ne*_[K+y];return _[$+g+1]=_[$+g+1]+ne,700}for(j=0,y=1;y<=c;y+=1)j+=_[X+y]*h[y][G];for(W=-_[Z+G]/j,ae=!0,oe||ne<W&&(W=ne,ae=!1),y=1;y<=c;y+=1)m[y]=m[y]+W*_[X+y],Math.abs(m[y])<pe&&(m[y]=0);for(d[1]=d[1]+W*j*(W/2+_[$+g+1]),y=1;y<=g;y+=1)_[$+y]=_[$+y]-W*_[K+y];if(_[$+g+1]=_[$+g+1]+W,!ae){for(j=-p[G],O=1;O<=c;O+=1)j+=m[O]*h[O][G];if(G>M)_[Z+G]=j;else if(_[Z+G]=-Math.abs(j),j>0){for(O=1;O<=c;O+=1)h[O][G]=-h[O][G];p[G]=-p[G]}return 700}for(g+=1,x[g]=G,V=se+(g-1)*g/2+1,y=1;y<=g-1;y+=1)_[V]=_[y],V+=1;if(g===c)_[V]=_[c];else{for(y=c;y>=g+1&&!(_[y]===0||(z=Math.max(Math.abs(_[y-1]),Math.abs(_[y])),Q=Math.min(Math.abs(_[y-1]),Math.abs(_[y])),_[y-1]>=0?q=Math.abs(z*Math.sqrt(1+Q*Q/(z*z))):q=-Math.abs(z*Math.sqrt(1+Q*Q/(z*z))),z=_[y-1]/q,Q=_[y]/q,z===1));y-=1)if(z===0)for(_[y-1]=Q*q,O=1;O<=c;O+=1)q=u[O][y-1],u[O][y-1]=u[O][y],u[O][y]=q;else for(_[y-1]=q,de=Q/(1+z),O=1;O<=c;O+=1)q=z*u[O][y-1]+Q*u[O][y],u[O][y]=de*(u[O][y-1]+q)-u[O][y],u[O][y-1]=q;_[V]=_[g]}return 0}function P(){if(V=se+H*(H+1)/2+1,N=V+H,_[N]===0||(z=Math.max(Math.abs(_[N-1]),Math.abs(_[N])),Q=Math.min(Math.abs(_[N-1]),Math.abs(_[N])),_[N-1]>=0?q=Math.abs(z*Math.sqrt(1+Q*Q/(z*z))):q=-Math.abs(z*Math.sqrt(1+Q*Q/(z*z))),z=_[N-1]/q,Q=_[N]/q,z===1))return 798;if(z===0){for(y=H+1;y<=g;y+=1)q=_[N-1],_[N-1]=_[N],_[N]=q,N+=y;for(y=1;y<=c;y+=1)q=u[y][H],u[y][H]=u[y][H+1],u[y][H+1]=q}else{for(de=Q/(1+z),y=H+1;y<=g;y+=1)q=z*_[N-1]+Q*_[N],_[N]=de*(_[N-1]+q)-_[N],_[N-1]=q,N+=y;for(y=1;y<=c;y+=1)q=z*u[y][H]+Q*u[y][H+1],u[y][H+1]=de*(u[y][H]+q)-u[y][H+1],u[y][H]=q}return 0}function D(){for(N=V-H,y=1;y<=H;y+=1)_[N]=_[V],V+=1,N+=1;return _[$+H]=_[$+H+1],x[H]=x[H+1],H+=1,H<g?797:0}function I(){return _[$+g]=_[$+g+1],_[$+g+1]=0,x[g]=0,g-=1,b[2]=b[2]+1,0}var y,O,V,N,ee,H,X,K,se,Z,$,G,Y,le,q,j,ne,W,z,Q,de,oe,ae,pe,Ke,Oe,he;Y=Math.min(c,w),V=2*c+Y*(Y+5)/2+2*w+1,pe=1e-60;do pe+=pe,Ke=1+.1*pe,Oe=1+.2*pe;while(Ke<=1||Oe<=1);for(y=1;y<=c;y+=1)_[y]=f[y];for(y=c+1;y<=V;y+=1)_[y]=0;for(y=1;y<=w;y+=1)x[y]=0;if(ee=[],E[1]===0){if(o(u,l,c,ee),ee[1]!==0){E[1]=2;return}r(u,l,c,f),i(u,l,c)}else{for(O=1;O<=c;O+=1)for(m[O]=0,y=1;y<=O;y+=1)m[O]=m[O]+u[y][O]*f[y];for(O=1;O<=c;O+=1)for(f[O]=0,y=O;y<=c;y+=1)f[O]=f[O]+u[O][y]*m[y]}for(d[1]=0,O=1;O<=c;O+=1)for(m[O]=f[O],d[1]=d[1]+_[O]*m[O],_[O]=0,y=O+1;y<=c;y+=1)u[y][O]=0;for(d[1]=-d[1]/2,E[1]=0,X=c,K=X+c,$=K+Y,se=$+Y+1,Z=se+Y*(Y+1)/2,le=Z+w,y=1;y<=w;y+=1){for(j=0,O=1;O<=c;O+=1)j+=h[O][y]*h[O][y];_[le+y]=Math.sqrt(j)}for(g=0,b[1]=0,b[2]=0,he=0;;){if(he=R(),he===999)return;for(;he=F(),he!==0;){if(he===999)return;if(he===700)if(H===g)I();else{for(;P(),he=D(),he===797;);I()}}}}function s(u,f,l,c,m,d){u=e(u),f=e(f),l=e(l);var h,p,v,w,M,x=[],g=[],b=[],_=[],E=[],R;if(m=m||0,d=d?e(d):[void 0,0],c=c?e(c):[],p=u.length-1,v=l[1].length-1,!c)for(h=1;h<=v;h+=1)c[h]=0;for(h=1;h<=v;h+=1)g[h]=0;for(w=0,M=Math.min(p,v),h=1;h<=p;h+=1)b[h]=0;for(x[1]=0,h=1;h<=2*p+M*(M+5)/2+2*v+1;h+=1)_[h]=0;for(h=1;h<=2;h+=1)E[h]=0;return a(u,f,p,p,b,x,l,c,p,v,m,g,w,E,_,d),R="",d[1]===1&&(R="constraints are inconsistent, no solution!"),d[1]===2&&(R="matrix D in quadratic function is not positive definite!"),{solution:t(b),value:t(x),unconstrained_solution:t(f),iterations:t(E),iact:t(g),message:R}}n.solveQP=s})(numeric),numeric.svd=function(n){function e(D,I){return D=Math.abs(D),I=Math.abs(I),D>I?D*Math.sqrt(1+I*I/D/D):I==0?D:I*Math.sqrt(1+D*D/I/I)}var t,i=numeric.epsilon,r=1e-64/i,o=50,a=0,s=0,u=0,f=0,l=0,c=numeric.clone(n),m=c.length,d=c[0].length;if(m<d)throw"Need more rows than columns";var h=new Array(d),p=new Array(d);for(s=0;s<d;s++)h[s]=p[s]=0;var v=numeric.rep([d,d],0),w=0,M=0,x=0,g=0,b=0,_=0,E=0;for(s=0;s<d;s++){for(h[s]=M,E=0,l=s+1,u=s;u<m;u++)E+=c[u][s]*c[u][s];if(E<=r)M=0;else for(w=c[s][s],M=Math.sqrt(E),w>=0&&(M=-M),x=w*M-E,c[s][s]=w-M,u=l;u<d;u++){for(E=0,f=s;f<m;f++)E+=c[f][s]*c[f][u];for(w=E/x,f=s;f<m;f++)c[f][u]+=w*c[f][s]}for(p[s]=M,E=0,u=l;u<d;u++)E+=c[s][u]*c[s][u];if(E<=r)M=0;else{for(w=c[s][s+1],M=Math.sqrt(E),w>=0&&(M=-M),x=w*M-E,c[s][s+1]=w-M,u=l;u<d;u++)h[u]=c[s][u]/x;for(u=l;u<m;u++){for(E=0,f=l;f<d;f++)E+=c[u][f]*c[s][f];for(f=l;f<d;f++)c[u][f]+=E*h[f]}}b=Math.abs(p[s])+Math.abs(h[s]),b>g&&(g=b)}for(s=d-1;s!=-1;s+=-1){if(M!=0){for(x=M*c[s][s+1],u=l;u<d;u++)v[u][s]=c[s][u]/x;for(u=l;u<d;u++){for(E=0,f=l;f<d;f++)E+=c[s][f]*v[f][u];for(f=l;f<d;f++)v[f][u]+=E*v[f][s]}}for(u=l;u<d;u++)v[s][u]=0,v[u][s]=0;v[s][s]=1,M=h[s],l=s}for(s=d-1;s!=-1;s+=-1){for(l=s+1,M=p[s],u=l;u<d;u++)c[s][u]=0;if(M!=0){for(x=c[s][s]*M,u=l;u<d;u++){for(E=0,f=l;f<m;f++)E+=c[f][s]*c[f][u];for(w=E/x,f=s;f<m;f++)c[f][u]+=w*c[f][s]}for(u=s;u<m;u++)c[u][s]=c[u][s]/M}else for(u=s;u<m;u++)c[u][s]=0;c[s][s]+=1}for(i*=g,f=d-1;f!=-1;f+=-1)for(var R=0;R<o;R++){var F=!1;for(l=f;l!=-1;l+=-1){if(Math.abs(h[l])<=i){F=!0;break}if(Math.abs(p[l-1])<=i)break}if(!F){a=0,E=1;var P=l-1;for(s=l;s<f+1&&(w=E*h[s],h[s]=a*h[s],!(Math.abs(w)<=i));s++)for(M=p[s],x=e(w,M),p[s]=x,a=M/x,E=-w/x,u=0;u<m;u++)b=c[u][P],_=c[u][s],c[u][P]=b*a+_*E,c[u][s]=-b*E+_*a}if(_=p[f],l==f){if(_<0)for(p[f]=-_,u=0;u<d;u++)v[u][f]=-v[u][f];break}if(R>=o-1)throw"Error: no convergence.";for(g=p[l],b=p[f-1],M=h[f-1],x=h[f],w=((b-_)*(b+_)+(M-x)*(M+x))/(2*x*b),M=e(w,1),w<0?w=((g-_)*(g+_)+x*(b/(w-M)-x))/g:w=((g-_)*(g+_)+x*(b/(w+M)-x))/g,a=1,E=1,s=l+1;s<f+1;s++){for(M=h[s],b=p[s],x=E*M,M=a*M,_=e(w,x),h[s-1]=_,a=w/_,E=x/_,w=g*a+M*E,M=-g*E+M*a,x=b*E,b*=a,u=0;u<d;u++)g=v[u][s-1],_=v[u][s],v[u][s-1]=g*a+_*E,v[u][s]=-g*E+_*a;for(_=e(w,x),p[s-1]=_,a=w/_,E=x/_,w=a*M+E*b,g=-E*M+a*b,u=0;u<m;u++)b=c[u][s-1],_=c[u][s],c[u][s-1]=b*a+_*E,c[u][s]=-b*E+_*a}h[l]=0,h[f]=w,p[f]=g}for(s=0;s<p.length;s++)p[s]<i&&(p[s]=0);for(s=0;s<d;s++)for(u=s-1;u>=0;u--)if(p[u]<p[s]){for(a=p[u],p[u]=p[s],p[s]=a,f=0;f<c.length;f++)t=c[f][s],c[f][s]=c[f][u],c[f][u]=t;for(f=0;f<v.length;f++)t=v[f][s],v[f][s]=v[f][u],v[f][u]=t;s=u}return{U:c,S:p,V:v}}});var ve=1e-6,ye=typeof Float32Array<"u"?Float32Array:Array,gn=Math.random;function en(n){return n>=0?Math.round(n):n%.5===0?Math.floor(n):Math.round(n)}var Yr=Math.PI/180,$r=180/Math.PI;var me={};_n(me,{add:()=>Et,clone:()=>lt,copy:()=>dt,create:()=>ft,determinant:()=>gt,equals:()=>Ot,exactEquals:()=>Tt,frob:()=>Mt,fromRotation:()=>xt,fromScaling:()=>wt,fromTranslation:()=>At,fromValues:()=>mt,identity:()=>ht,invert:()=>_t,mul:()=>Lt,multiply:()=>yn,multiplyScalar:()=>St,multiplyScalarAndAdd:()=>Ct,rotate:()=>vt,scale:()=>yt,set:()=>pt,str:()=>kt,sub:()=>Rt,subtract:()=>bn,translate:()=>bt});function ft(){var n=new ye(6);return ye!=Float32Array&&(n[1]=0,n[2]=0,n[4]=0,n[5]=0),n[0]=1,n[3]=1,n}function lt(n){var e=new ye(6);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e}function dt(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function ht(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function mt(n,e,t,i,r,o){var a=new ye(6);return a[0]=n,a[1]=e,a[2]=t,a[3]=i,a[4]=r,a[5]=o,a}function pt(n,e,t,i,r,o,a){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n[4]=o,n[5]=a,n}function _t(n,e){var t=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=t*o-i*r;return u?(u=1/u,n[0]=o*u,n[1]=-i*u,n[2]=-r*u,n[3]=t*u,n[4]=(r*s-o*a)*u,n[5]=(i*a-t*s)*u,n):null}function gt(n){return n[0]*n[3]-n[1]*n[2]}function yn(n,e,t){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],f=t[0],l=t[1],c=t[2],m=t[3],d=t[4],h=t[5];return n[0]=i*f+o*l,n[1]=r*f+a*l,n[2]=i*c+o*m,n[3]=r*c+a*m,n[4]=i*d+o*h+s,n[5]=r*d+a*h+u,n}function vt(n,e,t){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],f=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*f,n[1]=r*l+a*f,n[2]=i*-f+o*l,n[3]=r*-f+a*l,n[4]=s,n[5]=u,n}function yt(n,e,t){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],f=t[0],l=t[1];return n[0]=i*f,n[1]=r*f,n[2]=o*l,n[3]=a*l,n[4]=s,n[5]=u,n}function bt(n,e,t){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],f=t[0],l=t[1];return n[0]=i,n[1]=r,n[2]=o,n[3]=a,n[4]=i*f+o*l+s,n[5]=r*f+a*l+u,n}function xt(n,e){var t=Math.sin(e),i=Math.cos(e);return n[0]=i,n[1]=t,n[2]=-t,n[3]=i,n[4]=0,n[5]=0,n}function wt(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=e[1],n[4]=0,n[5]=0,n}function At(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=e[0],n[5]=e[1],n}function kt(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"}function Mt(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]+n[3]*n[3]+n[4]*n[4]+n[5]*n[5]+1)}function Et(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n}function bn(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n}function St(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n}function Ct(n,e,t,i){return n[0]=e[0]+t[0]*i,n[1]=e[1]+t[1]*i,n[2]=e[2]+t[2]*i,n[3]=e[3]+t[3]*i,n[4]=e[4]+t[4]*i,n[5]=e[5]+t[5]*i,n}function Tt(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]}function Ot(n,e){var t=n[0],i=n[1],r=n[2],o=n[3],a=n[4],s=n[5],u=e[0],f=e[1],l=e[2],c=e[3],m=e[4],d=e[5];return Math.abs(t-u)<=ve*Math.max(1,Math.abs(t),Math.abs(u))&&Math.abs(i-f)<=ve*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(r-l)<=ve*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-c)<=ve*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-m)<=ve*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-d)<=ve*Math.max(1,Math.abs(s),Math.abs(d))}var Lt=yn,Rt=bn;var U={};_n(U,{add:()=>jt,angle:()=>rr,ceil:()=>Bt,clone:()=>Pt,copy:()=>Vt,create:()=>xn,cross:()=>Wt,dist:()=>hr,distance:()=>Mn,div:()=>dr,divide:()=>kn,dot:()=>Xt,equals:()=>ur,exactEquals:()=>sr,floor:()=>Dt,forEach:()=>_r,fromValues:()=>Nt,inverse:()=>$t,len:()=>cr,length:()=>Sn,lerp:()=>Qt,max:()=>Ht,min:()=>It,mul:()=>lr,multiply:()=>An,negate:()=>Yt,normalize:()=>Gt,random:()=>Jt,rotate:()=>tr,round:()=>zt,scale:()=>Ut,scaleAndAdd:()=>qt,set:()=>Ft,signedAngle:()=>ir,sqrDist:()=>mr,sqrLen:()=>pr,squaredDistance:()=>En,squaredLength:()=>Cn,str:()=>ar,sub:()=>fr,subtract:()=>wn,transformMat2:()=>Kt,transformMat2d:()=>Zt,transformMat3:()=>er,transformMat4:()=>nr,zero:()=>or});function xn(){var n=new ye(2);return ye!=Float32Array&&(n[0]=0,n[1]=0),n}function Pt(n){var e=new ye(2);return e[0]=n[0],e[1]=n[1],e}function Nt(n,e){var t=new ye(2);return t[0]=n,t[1]=e,t}function Vt(n,e){return n[0]=e[0],n[1]=e[1],n}function Ft(n,e,t){return n[0]=e,n[1]=t,n}function jt(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function wn(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function An(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n}function kn(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n}function Bt(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n}function Dt(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n}function It(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function Ht(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}function zt(n,e){return n[0]=en(e[0]),n[1]=en(e[1]),n}function Ut(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function qt(n,e,t,i){return n[0]=e[0]+t[0]*i,n[1]=e[1]+t[1]*i,n}function Mn(n,e){var t=e[0]-n[0],i=e[1]-n[1];return Math.sqrt(t*t+i*i)}function En(n,e){var t=e[0]-n[0],i=e[1]-n[1];return t*t+i*i}function Sn(n){var e=n[0],t=n[1];return Math.sqrt(e*e+t*t)}function Cn(n){var e=n[0],t=n[1];return e*e+t*t}function Yt(n,e){return n[0]=-e[0],n[1]=-e[1],n}function $t(n,e){return n[0]=1/e[0],n[1]=1/e[1],n}function Gt(n,e){var t=e[0],i=e[1],r=t*t+i*i;return r>0&&(r=1/Math.sqrt(r)),n[0]=e[0]*r,n[1]=e[1]*r,n}function Xt(n,e){return n[0]*e[0]+n[1]*e[1]}function Wt(n,e,t){var i=e[0]*t[1]-e[1]*t[0];return n[0]=n[1]=0,n[2]=i,n}function Qt(n,e,t,i){var r=e[0],o=e[1];return n[0]=r+i*(t[0]-r),n[1]=o+i*(t[1]-o),n}function Jt(n,e){e=e===void 0?1:e;var t=gn()*2*Math.PI;return n[0]=Math.cos(t)*e,n[1]=Math.sin(t)*e,n}function Kt(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n}function Zt(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[2]*r+t[4],n[1]=t[1]*i+t[3]*r+t[5],n}function er(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}function nr(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}function tr(n,e,t,i){var r=e[0]-t[0],o=e[1]-t[1],a=Math.sin(i),s=Math.cos(i);return n[0]=r*s-o*a+t[0],n[1]=r*a+o*s+t[1],n}function rr(n,e){var t=n[0],i=n[1],r=e[0],o=e[1];return Math.abs(Math.atan2(i*r-t*o,t*r+i*o))}function ir(n,e){var t=n[0],i=n[1],r=e[0],o=e[1];return Math.atan2(t*o-i*r,t*r+i*o)}function or(n){return n[0]=0,n[1]=0,n}function ar(n){return"vec2("+n[0]+", "+n[1]+")"}function sr(n,e){return n[0]===e[0]&&n[1]===e[1]}function ur(n,e){var t=n[0],i=n[1],r=e[0],o=e[1];return Math.abs(t-r)<=ve*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(i-o)<=ve*Math.max(1,Math.abs(i),Math.abs(o))}var cr=Sn,fr=wn,lr=An,dr=kn,hr=Mn,mr=En,pr=Cn,_r=(function(){var n=xn();return function(e,t,i,r,o,a){var s,u;for(t||(t=2),i||(i=0),r?u=Math.min(r*t+i,e.length):u=e.length,s=i;s<u;s+=t)n[0]=e[s],n[1]=e[s+1],o(n,n,a),e[s]=n[0],e[s+1]=n[1];return e}})();function gr(n,e){let t=n[0],i=n[1],r=e[0],o=e[1];return Math.atan2(t*o-i*r,t*r+i*o)}var qe=class n{constructor(e,t,i){this.translation=U.create(),this.zoom=1,this.rotation=0,this.translation=e||this.translation,this.zoom=t||this.zoom,this.rotation=i||this.rotation}translationMatrix(){return me.fromTranslation(me.create(),this.translation)}scalingMatrix(){return me.fromScaling(me.create(),[this.zoom,this.zoom])}rotationMatrix(){return me.fromRotation(me.create(),this.rotation)}matrix(){let e=me.create();return me.mul(e,this.translationMatrix(),this.scalingMatrix()),me.mul(e,e,this.rotationMatrix()),e}translate(e){U.add(this.translation,this.translation,e)}zoomInto(e,t){this.zoom*=t,U.sub(this.translation,this.translation,e),U.scaleAndAdd(this.translation,e,this.translation,t)}rotateAround(e,t){this.rotation+=t,U.rotate(this.translation,this.translation,e,t)}lerp(e,t){U.lerp(this.translation,this.translation,e.translation,t),this.zoom=(1-t)*this.zoom+t*e.zoom,this.rotation=(1-t)*this.rotation+t*e.rotation}copy(e){U.copy(this.translation,e.translation),this.zoom=e.zoom,this.rotation=e.rotation}apply(e){return U.transformMat2d(e,e,this.matrix())}inverse(){let e=U.negate(U.create(),this.translation);return U.scale(e,e,1/this.zoom),U.rotate(e,e,U.create(),-this.rotation),new n(e,1/this.zoom,-this.rotation)}},Ne=class{constructor(e){this._listeners=[],this.config={scroll_sensitivity:1.01,rotation_sensitivity:.01,damping_strength:0,panning:!0,zooming:!0,rotating:!0};let t=e instanceof HTMLCanvasElement?e.getContext("2d"):e;if(t===null)throw new Error("Failed to get CanvasRenderingContext2D");this.ctx=t,this.transform=new qe,this.target_transform=new qe,this.canvas.style.touchAction="none",vr(this,this.canvas)}updateDamping(e,t=!0){this.transform.lerp(this.target_transform,1-Math.exp(-e/this.config.damping_strength)),t&&this.updateTransform()}updateTransform(){this.config.damping_strength===0&&this.transform.copy(this.target_transform),this.ctx.resetTransform(),this.ctx.translate(...this.transform.translation),this.ctx.rotate(this.transform.rotation),this.ctx.scale(this.transform.zoom,this.transform.zoom),this._listeners.forEach(e=>e(this))}renderSpaceToScreen(e){return this.transform.apply(e)}screenToRenderSpace(e){return this.transform.inverse().apply(e)}getScreenAABB(){let e=[U.fromValues(0,0),U.fromValues(0,this.canvas.height),U.fromValues(this.canvas.width,0),U.fromValues(this.canvas.width,this.canvas.height)].map(this.screenToRenderSpace.bind(this)),t=e.map(r=>r[0]),i=e.map(r=>r[1]);return[U.fromValues(Math.min(...t),Math.min(...i)),U.fromValues(Math.max(...t),Math.max(...i))]}translate(e){this.target_transform.translate(e)}zoomInto(e,t){this.target_transform.zoomInto(e,t)}rotateAround(e,t){this.target_transform.rotateAround(e,t)}lerp(e,t){this.target_transform.lerp(e,t)}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners.splice(this._listeners.indexOf(e),1)}clearScreen(){this.ctx.save(),this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore()}get canvas(){return this.ctx.canvas}get listeners(){return this._listeners.slice()}};function vr(n,e){let t={};e.addEventListener("contextmenu",i=>i.preventDefault()),e.addEventListener("pointerdown",i=>{t[i.pointerId]={pos:U.fromValues(i.offsetX,i.offsetY),button:i.button}}),e.addEventListener("pointerup",i=>{delete t[i.pointerId]}),e.addEventListener("pointermove",i=>{let r=t[i.pointerId];if(!r)return;let o=U.clone(r.pos);switch(U.set(r.pos,i.offsetX,i.offsetY),Object.keys(t).length){case 1:r.button===2&&n.config.rotating&&n.rotateAround([e.width/2,e.height/2],n.config.rotation_sensitivity*(r.pos[0]-o[0])),r.button==0&&n.config.panning&&n.translate(U.sub(U.create(),r.pos,o)),n.updateTransform();break;case 2:let a=Object.values(t).find(l=>l!==r);if(a===void 0)throw new Error("something is really wrong bro, good luck debugging ts");let s=U.add(U.create(),r.pos,a.pos);U.scale(s,s,.5);let u=U.sub(U.create(),r.pos,a.pos),f=U.sub(U.create(),o,a.pos);if(n.config.panning){let l=U.sub(U.create(),r.pos,o);n.translate(U.scale(l,l,.5))}n.config.zooming&&n.zoomInto(s,U.len(u)/U.len(f)),n.config.rotating&&n.rotateAround(s,gr(f,u)),n.updateTransform();break}}),e.addEventListener("wheel",i=>{if(!n.config.zooming)return;let r=Math.pow(n.config.scroll_sensitivity,-i.deltaY);n.zoomInto([i.offsetX,i.offsetY],r),n.updateTransform(),i.preventDefault()},{passive:!1})}function yr(n){if(n&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function Pe(n,e){var t=n.__state.conversionName.toString(),i=Math.round(n.r),r=Math.round(n.g),o=Math.round(n.b),a=n.a,s=Math.round(n.h),u=n.s.toFixed(1),f=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var l=n.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}else{if(t==="CSS_RGB")return"rgb("+i+","+r+","+o+")";if(t==="CSS_RGBA")return"rgba("+i+","+r+","+o+","+a+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+i+","+r+","+o+"]";if(t==="RGBA_ARRAY")return"["+i+","+r+","+o+","+a+"]";if(t==="RGB_OBJ")return"{r:"+i+",g:"+r+",b:"+o+"}";if(t==="RGBA_OBJ")return"{r:"+i+",g:"+r+",b:"+o+",a:"+a+"}";if(t==="HSV_OBJ")return"{h:"+s+",s:"+u+",v:"+f+"}";if(t==="HSVA_OBJ")return"{h:"+s+",s:"+u+",v:"+f+",a:"+a+"}"}return"unknown format"}var Tn=Array.prototype.forEach,Ve=Array.prototype.slice,L={BREAK:{},extend:function(e){return this.each(Ve.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(Ve.call(arguments,1),function(t){var i=this.isObject(t)?Object.keys(t):[];i.forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=Ve.call(arguments);return function(){for(var t=Ve.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e){if(Tn&&e.forEach&&e.forEach===Tn)e.forEach(t,i);else if(e.length===e.length+0){var r=void 0,o=void 0;for(r=0,o=e.length;r<o;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var a in e)if(t.call(i,e[a],a)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var r=void 0;return function(){var o=this,a=arguments;function s(){r=null,i||e.apply(o,a)}var u=i||!r;clearTimeout(r),r=setTimeout(s,t),u&&e.apply(o,a)}},toArray:function(e){return e.toArray?e.toArray():Ve.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:(function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e})(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},br=[{litmus:L.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Pe},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Pe},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Pe},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Pe}}},{litmus:L.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:L.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:L.isObject,conversions:{RGBA_OBJ:{read:function(e){return L.isNumber(e.r)&&L.isNumber(e.g)&&L.isNumber(e.b)&&L.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return L.isNumber(e.r)&&L.isNumber(e.g)&&L.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return L.isNumber(e.h)&&L.isNumber(e.s)&&L.isNumber(e.v)&&L.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return L.isNumber(e.h)&&L.isNumber(e.s)&&L.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],Fe=void 0,Ye=void 0,tn=function(){Ye=!1;var e=arguments.length>1?L.toArray(arguments):arguments[0];return L.each(br,function(t){if(t.litmus(e))return L.each(t.conversions,function(i,r){if(Fe=i.read(e),Ye===!1&&Fe!==!1)return Ye=Fe,Fe.conversionName=r,Fe.conversion=i,L.BREAK}),L.BREAK}),Ye},On=void 0,Ge={hsv_to_rgb:function(e,t,i){var r=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),a=i*(1-t),s=i*(1-o*t),u=i*(1-(1-o)*t),f=[[i,u,a],[s,i,a],[a,i,u],[a,s,i],[u,a,i],[i,a,s]][r];return{r:f[0]*255,g:f[1]*255,b:f[2]*255}},rgb_to_hsv:function(e,t,i){var r=Math.min(e,t,i),o=Math.max(e,t,i),a=o-r,s=void 0,u=void 0;if(o!==0)u=a/o;else return{h:NaN,s:0,v:0};return e===o?s=(t-i)/a:t===o?s=2+(i-e)/a:s=4+(e-t)/a,s/=6,s<0&&(s+=1),{h:s*360,s:u,v:o/255}},rgb_to_hex:function(e,t,i){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,i),r},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,i){return i<<(On=t*8)|e&~(255<<On)}},xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_e=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},ge=(function(){function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}})(),we=function n(e,t,i){e===null&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(r===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:n(o,t,i)}else{if("value"in r)return r.value;var a=r.get;return a===void 0?void 0:a.call(i)}},Ae=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},ke=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},ue=(function(){function n(){if(_e(this,n),this.__state=tn.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return ge(n,[{key:"toString",value:function(){return Pe(this)}},{key:"toHexString",value:function(){return Pe(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n})();function cn(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(ue.recalculateRGB(this,e,t),this.__state[e])},set:function(r){this.__state.space!=="RGB"&&(ue.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function fn(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(ue.recalculateHSV(this),this.__state[e])},set:function(i){this.__state.space!=="HSV"&&(ue.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}ue.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=Ge.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")L.extend(n.__state,Ge.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};ue.recalculateHSV=function(n){var e=Ge.rgb_to_hsv(n.r,n.g,n.b);L.extend(n.__state,{s:e.s,v:e.v}),L.isNaN(e.h)?L.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};ue.COMPONENTS=["r","g","b","h","s","v","hex","a"];cn(ue.prototype,"r",2);cn(ue.prototype,"g",1);cn(ue.prototype,"b",0);fn(ue.prototype,"h");fn(ue.prototype,"s");fn(ue.prototype,"v");Object.defineProperty(ue.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(ue.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Ge.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Se=(function(){function n(e,t){_e(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return ge(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n})(),wr={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},In={};L.each(wr,function(n,e){L.each(n,function(t){In[t]=e})});var Ar=/(\d+(\.\d+)?)px/;function be(n){if(n==="0"||L.isUndefined(n))return 0;var e=n.match(Ar);return L.isNull(e)?0:parseFloat(e[1])}var S={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var r=i,o=t;L.isUndefined(o)&&(o=!0),L.isUndefined(r)&&(r=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,r){var o=i||{},a=In[t];if(!a)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":{var u=o.x||o.clientX||0,f=o.y||o.clientY||0;s.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,u,f,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var l=s.initKeyboardEvent||s.initKeyEvent;L.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{s.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}}L.defaults(s,r),e.dispatchEvent(s)},bind:function(e,t,i,r){var o=r||!1;return e.addEventListener?e.addEventListener(t,i,o):e.attachEvent&&e.attachEvent("on"+t,i),S},unbind:function(e,t,i,r){var o=r||!1;return e.removeEventListener?e.removeEventListener(t,i,o):e.detachEvent&&e.detachEvent("on"+t,i),S},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);i.indexOf(t)===-1&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return S},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(t);r!==-1&&(i.splice(r,1),e.className=i.join(" "))}else e.className=void 0;return S},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return be(t["border-left-width"])+be(t["border-right-width"])+be(t["padding-left"])+be(t["padding-right"])+be(t.width)},getHeight:function(e){var t=getComputedStyle(e);return be(t["border-top-width"])+be(t["border-bottom-width"])+be(t["padding-top"])+be(t["padding-bottom"])+be(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent;while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Hn=(function(n){Ae(e,n);function e(t,i){_e(this,e);var r=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r;r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox");function a(){o.setValue(!o.__prev)}return S.bind(r.__checkbox,"change",a,!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return ge(e,[{key:"setValue",value:function(i){var r=we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(Se),kr=(function(n){Ae(e,n);function e(t,i,r){_e(this,e);var o=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=r,s=o;if(o.__select=document.createElement("select"),L.isArray(a)){var u={};L.each(a,function(f){u[f]=f}),a=u}return L.each(a,function(f,l){var c=document.createElement("option");c.innerHTML=l,c.setAttribute("value",f),s.__select.appendChild(c)}),o.updateDisplay(),S.bind(o.__select,"change",function(){var f=this.options[this.selectedIndex].value;s.setValue(f)}),o.domElement.appendChild(o.__select),o}return ge(e,[{key:"setValue",value:function(i){var r=we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return S.isActive(this.__select)?this:(this.__select.value=this.getValue(),we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e})(Se),Mr=(function(n){Ae(e,n);function e(t,i){_e(this,e);var r=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),o=r;function a(){o.setValue(o.__input.value)}function s(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),S.bind(r.__input,"keyup",a),S.bind(r.__input,"change",a),S.bind(r.__input,"blur",s),S.bind(r.__input,"keydown",function(u){u.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return ge(e,[{key:"updateDisplay",value:function(){return S.isActive(this.__input)||(this.__input.value=this.getValue()),we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(Se);function Ln(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var zn=(function(n){Ae(e,n);function e(t,i,r){_e(this,e);var o=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=r||{};return o.__min=a.min,o.__max=a.max,o.__step=a.step,L.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Ln(o.__impliedStep),o}return ge(e,[{key:"setValue",value:function(i){var r=i;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!==0&&(r=Math.round(r/this.__step)*this.__step),we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=Ln(i),this}}]),e})(Se);function Er(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var Xe=(function(n){Ae(e,n);function e(t,i,r){_e(this,e);var o=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r));o.__truncationSuspended=!1;var a=o,s=void 0;function u(){var h=parseFloat(a.__input.value);L.isNaN(h)||a.setValue(h)}function f(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function l(){f()}function c(h){var p=s-h.clientY;a.setValue(a.getValue()+p*a.__impliedStep),s=h.clientY}function m(){S.unbind(window,"mousemove",c),S.unbind(window,"mouseup",m),f()}function d(h){S.bind(window,"mousemove",c),S.bind(window,"mouseup",m),s=h.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),S.bind(o.__input,"change",u),S.bind(o.__input,"blur",l),S.bind(o.__input,"mousedown",d),S.bind(o.__input,"keydown",function(h){h.keyCode===13&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1,f())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return ge(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():Er(this.getValue(),this.__precision),we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(zn);function Rn(n,e,t,i,r){return i+(r-i)*((n-e)/(t-e))}var rn=(function(n){Ae(e,n);function e(t,i,r,o,a){_e(this,e);var s=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,{min:r,max:o,step:a})),u=s;s.__background=document.createElement("div"),s.__foreground=document.createElement("div"),S.bind(s.__background,"mousedown",f),S.bind(s.__background,"touchstart",m),S.addClass(s.__background,"slider"),S.addClass(s.__foreground,"slider-fg");function f(p){document.activeElement.blur(),S.bind(window,"mousemove",l),S.bind(window,"mouseup",c),l(p)}function l(p){p.preventDefault();var v=u.__background.getBoundingClientRect();return u.setValue(Rn(p.clientX,v.left,v.right,u.__min,u.__max)),!1}function c(){S.unbind(window,"mousemove",l),S.unbind(window,"mouseup",c),u.__onFinishChange&&u.__onFinishChange.call(u,u.getValue())}function m(p){p.touches.length===1&&(S.bind(window,"touchmove",d),S.bind(window,"touchend",h),d(p))}function d(p){var v=p.touches[0].clientX,w=u.__background.getBoundingClientRect();u.setValue(Rn(v,w.left,w.right,u.__min,u.__max))}function h(){S.unbind(window,"touchmove",d),S.unbind(window,"touchend",h),u.__onFinishChange&&u.__onFinishChange.call(u,u.getValue())}return s.updateDisplay(),s.__background.appendChild(s.__foreground),s.domElement.appendChild(s.__background),s}return ge(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=i*100+"%",we(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e})(zn),Un=(function(n){Ae(e,n);function e(t,i,r){_e(this,e);var o=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i)),a=o;return o.__button=document.createElement("div"),o.__button.innerHTML=r===void 0?"Fire":r,S.bind(o.__button,"click",function(s){return s.preventDefault(),a.fire(),!1}),S.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return ge(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e})(Se),on=(function(n){Ae(e,n);function e(t,i){_e(this,e);var r=ke(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));r.__color=new ue(r.getValue()),r.__temp=new ue(0);var o=r;r.domElement=document.createElement("div"),S.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",S.bind(r.__input,"keydown",function(p){p.keyCode===13&&c.call(this)}),S.bind(r.__input,"blur",c),S.bind(r.__selector,"mousedown",function(){S.addClass(this,"drag").bind(window,"mouseup",function(){S.removeClass(o.__selector,"drag")})}),S.bind(r.__selector,"touchstart",function(){S.addClass(this,"drag").bind(window,"touchend",function(){S.removeClass(o.__selector,"drag")})});var a=document.createElement("div");L.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),L.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),L.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),L.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),L.extend(a.style,{width:"100%",height:"100%",background:"none"}),Pn(a,"top","rgba(0,0,0,0)","#000"),L.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Cr(r.__hue_field),L.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),S.bind(r.__saturation_field,"mousedown",s),S.bind(r.__saturation_field,"touchstart",s),S.bind(r.__field_knob,"mousedown",s),S.bind(r.__field_knob,"touchstart",s),S.bind(r.__hue_field,"mousedown",u),S.bind(r.__hue_field,"touchstart",u);function s(p){d(p),S.bind(window,"mousemove",d),S.bind(window,"touchmove",d),S.bind(window,"mouseup",f),S.bind(window,"touchend",f)}function u(p){h(p),S.bind(window,"mousemove",h),S.bind(window,"touchmove",h),S.bind(window,"mouseup",l),S.bind(window,"touchend",l)}function f(){S.unbind(window,"mousemove",d),S.unbind(window,"touchmove",d),S.unbind(window,"mouseup",f),S.unbind(window,"touchend",f),m()}function l(){S.unbind(window,"mousemove",h),S.unbind(window,"touchmove",h),S.unbind(window,"mouseup",l),S.unbind(window,"touchend",l),m()}function c(){var p=tn(this.value);p!==!1?(o.__color.__state=p,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function m(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}r.__saturation_field.appendChild(a),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay();function d(p){p.type.indexOf("touch")===-1&&p.preventDefault();var v=o.__saturation_field.getBoundingClientRect(),w=p.touches&&p.touches[0]||p,M=w.clientX,x=w.clientY,g=(M-v.left)/(v.right-v.left),b=1-(x-v.top)/(v.bottom-v.top);return b>1?b=1:b<0&&(b=0),g>1?g=1:g<0&&(g=0),o.__color.v=b,o.__color.s=g,o.setValue(o.__color.toOriginal()),!1}function h(p){p.type.indexOf("touch")===-1&&p.preventDefault();var v=o.__hue_field.getBoundingClientRect(),w=p.touches&&p.touches[0]||p,M=w.clientY,x=1-(M-v.top)/(v.bottom-v.top);return x>1?x=1:x<0&&(x=0),o.__color.h=x*360,o.setValue(o.__color.toOriginal()),!1}return r}return ge(e,[{key:"updateDisplay",value:function(){var i=tn(this.getValue());if(i!==!1){var r=!1;L.each(ue.COMPONENTS,function(s){if(!L.isUndefined(i[s])&&!L.isUndefined(this.__color.__state[s])&&i[s]!==this.__color.__state[s])return r=!0,{}},this),r&&L.extend(this.__color.__state,i)}L.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,a=255-o;L.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,Pn(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),L.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})}}]),e})(Se),Sr=["-moz-","-o-","-webkit-","-ms-",""];function Pn(n,e,t,i){n.style.background="",L.each(Sr,function(r){n.style.cssText+="background: "+r+"linear-gradient("+e+", "+t+" 0%, "+i+" 100%); "})}function Cr(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Tr={load:function(e,t){var i=t||document,r=i.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,i.getElementsByTagName("head")[0].appendChild(r)},inject:function(e,t){var i=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var o=i.getElementsByTagName("head")[0];try{o.appendChild(r)}catch{}}},Or=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Lr=function(e,t){var i=e[t];return L.isArray(arguments[2])||L.isObject(arguments[2])?new kr(e,t,arguments[2]):L.isNumber(i)?L.isNumber(arguments[2])&&L.isNumber(arguments[3])?L.isNumber(arguments[4])?new rn(e,t,arguments[2],arguments[3],arguments[4]):new rn(e,t,arguments[2],arguments[3]):L.isNumber(arguments[4])?new Xe(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new Xe(e,t,{min:arguments[2],max:arguments[3]}):L.isString(i)?new Mr(e,t):L.isFunction(i)?new Un(e,t,""):L.isBoolean(i)?new Hn(e,t):null};function Rr(n){setTimeout(n,1e3/60)}var Pr=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Rr,Nr=(function(){function n(){_e(this,n),this.backgroundElement=document.createElement("div"),L.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),S.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),L.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;S.bind(this.backgroundElement,"click",function(){e.hide()})}return ge(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),L.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,i=function r(){t.domElement.style.display="none",t.backgroundElement.style.display="none",S.unbind(t.domElement,"webkitTransitionEnd",r),S.unbind(t.domElement,"transitionend",r),S.unbind(t.domElement,"oTransitionEnd",r)};S.bind(this.domElement,"webkitTransitionEnd",i),S.bind(this.domElement,"transitionend",i),S.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-S.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-S.getHeight(this.domElement)/2+"px"}}]),n})(),Vr=yr(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Tr.inject(Vr);var Nn="dg",Vn=72,Fn=20,Ie="Default",je=(function(){try{return!!window.localStorage}catch{return!1}})(),Be=void 0,jn=!0,Le=void 0,nn=!1,qn=[],J=function n(e){var t=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),S.addClass(this.domElement,Nn),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=L.defaults(i,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),i=L.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),L.isUndefined(i.load)?i.load={preset:Ie}:i.preset&&(i.load.preset=i.preset),L.isUndefined(i.parent)&&i.hideable&&qn.push(this),i.resizable=L.isUndefined(i.parent)&&i.resizable,i.autoPlace&&L.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=je&&localStorage.getItem(Re(this,"isLocal"))==="true",o=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:i.load.preset},set:function(m){t.parent?t.getRoot().preset=m:i.load.preset=m,Dr(this),t.revert()}},width:{get:function(){return i.width},set:function(m){i.width=m,un(t,m)}},name:{get:function(){return i.name},set:function(m){i.name=m,a&&(a.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(m){i.closed=m,i.closed?S.addClass(t.__ul,n.CLASS_CLOSED):S.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=m?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(m){je&&(r=m,m?S.bind(window,"unload",o):S.unbind(window,"unload",o),localStorage.setItem(Re(t,"isLocal"),m))}}}),L.isUndefined(i.parent)){if(this.closed=i.closed||!1,S.addClass(this.domElement,n.CLASS_MAIN),S.makeSelectable(this.domElement,!1),je&&r){t.useLocalStorage=!0;var s=localStorage.getItem(Re(this,"gui"));s&&(i.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,S.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),i.closeOnTop?(S.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(S.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),S.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{i.closed===void 0&&(i.closed=!0);var u=document.createTextNode(i.name);S.addClass(u,"controller-name"),a=ln(t,u);var f=function(m){return m.preventDefault(),t.closed=!t.closed,!1};S.addClass(this.__ul,n.CLASS_CLOSED),S.addClass(a,"title"),S.bind(a,"click",f),i.closed||(this.closed=!1)}i.autoPlace&&(L.isUndefined(i.parent)&&(jn&&(Le=document.createElement("div"),S.addClass(Le,Nn),S.addClass(Le,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Le),jn=!1),Le.appendChild(this.domElement),S.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||un(t,i.width)),this.__resizeHandler=function(){t.onResizeDebounced()},S.bind(window,"resize",this.__resizeHandler),S.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),S.bind(this.__ul,"transitionend",this.__resizeHandler),S.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&Br(this),o=function(){je&&localStorage.getItem(Re(t,"isLocal"))==="true"&&localStorage.setItem(Re(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function l(){var c=t.getRoot();c.width+=1,L.defer(function(){c.width-=1})}i.parent||l()};J.toggleHide=function(){nn=!nn,L.each(qn,function(n){n.domElement.style.display=nn?"none":""})};J.CLASS_AUTO_PLACE="a";J.CLASS_AUTO_PLACE_CONTAINER="ac";J.CLASS_MAIN="main";J.CLASS_CONTROLLER_ROW="cr";J.CLASS_TOO_TALL="taller-than-window";J.CLASS_CLOSED="closed";J.CLASS_CLOSE_BUTTON="close-button";J.CLASS_CLOSE_TOP="close-top";J.CLASS_CLOSE_BOTTOM="close-bottom";J.CLASS_DRAG="drag";J.DEFAULT_WIDTH=245;J.TEXT_CLOSED="Close Controls";J.TEXT_OPEN="Open Controls";J._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===Vn||n.keyCode===Vn)&&J.toggleHide()};S.bind(window,"keydown",J._keydownHandler,!1);L.extend(J.prototype,{add:function(e,t){return De(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return De(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;L.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Le.removeChild(this.domElement);var e=this;L.each(this.__folders,function(t){e.removeFolder(t)}),S.unbind(window,"keydown",J._keydownHandler,!1),Bn(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new J(t);this.__folders[e]=i;var r=ln(this,i.domElement);return S.addClass(r,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Bn(e);var t=this;L.each(e.__folders,function(i){e.removeFolder(i)}),L.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=S.getOffset(e.__ul).top,i=0;L.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(i+=S.getHeight(r))}),window.innerHeight-t-Fn<i?(S.addClass(e.domElement,J.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-Fn+"px"):(S.removeClass(e.domElement,J.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&L.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:L.debounce(function(){this.onResize()},50),remember:function(){if(L.isUndefined(Be)&&(Be=new Nr,Be.domElement.innerHTML=Or),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;L.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&jr(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&un(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=$e(this)),e.folders={},L.each(this.__folders,function(t,i){e.folders[i]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=$e(this),an(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Ie]=$e(this,!0)),this.load.remembered[e]=$e(this),this.preset=e,sn(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){L.each(this.__controllers,function(t){this.getRoot().load.remembered?Yn(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),L.each(this.__folders,function(t){t.revert(t)}),e||an(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&$n(this.__listening)},updateDisplay:function(){L.each(this.__controllers,function(e){e.updateDisplay()}),L.each(this.__folders,function(e){e.updateDisplay()})}});function ln(n,e,t){var i=document.createElement("li");return e&&i.appendChild(e),t?n.__ul.insertBefore(i,t):n.__ul.appendChild(i),n.onResize(),i}function Bn(n){S.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&S.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function an(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function Fr(n,e,t){if(t.__li=e,t.__gui=n,L.extend(t,{options:function(a){if(arguments.length>1){var s=t.__li.nextElementSibling;return t.remove(),De(n,t.object,t.property,{before:s,factoryArgs:[L.toArray(arguments)]})}if(L.isArray(a)||L.isObject(a)){var u=t.__li.nextElementSibling;return t.remove(),De(n,t.object,t.property,{before:u,factoryArgs:[a]})}},name:function(a){return t.__li.firstElementChild.firstElementChild.innerHTML=a,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof rn){var i=new Xe(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});L.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var a=t[o],s=i[o];t[o]=i[o]=function(){var u=Array.prototype.slice.call(arguments);return s.apply(i,u),a.apply(t,u)}}),S.addClass(e,"has-slider"),t.domElement.insertBefore(i.domElement,t.domElement.firstElementChild)}else if(t instanceof Xe){var r=function(a){if(L.isNumber(t.__min)&&L.isNumber(t.__max)){var s=t.__li.firstElementChild.firstElementChild.innerHTML,u=t.__gui.__listening.indexOf(t)>-1;t.remove();var f=De(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return f.name(s),u&&f.listen(),f}return a};t.min=L.compose(r,t.min),t.max=L.compose(r,t.max)}else t instanceof Hn?(S.bind(e,"click",function(){S.fakeEvent(t.__checkbox,"click")}),S.bind(t.__checkbox,"click",function(o){o.stopPropagation()})):t instanceof Un?(S.bind(e,"click",function(){S.fakeEvent(t.__button,"click")}),S.bind(e,"mouseover",function(){S.addClass(t.__button,"hover")}),S.bind(e,"mouseout",function(){S.removeClass(t.__button,"hover")})):t instanceof on&&(S.addClass(e,"color"),t.updateDisplay=L.compose(function(o){return e.style.borderLeftColor=t.__color.toString(),o},t.updateDisplay),t.updateDisplay());t.setValue=L.compose(function(o){return n.getRoot().__preset_select&&t.isModified()&&an(n.getRoot(),!0),o},t.setValue)}function Yn(n,e){var t=n.getRoot(),i=t.__rememberedObjects.indexOf(e.object);if(i!==-1){var r=t.__rememberedObjectIndecesToControllers[i];if(r===void 0&&(r={},t.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,t.load&&t.load.remembered){var o=t.load.remembered,a=void 0;if(o[n.preset])a=o[n.preset];else if(o[Ie])a=o[Ie];else return;if(a[i]&&a[i][e.property]!==void 0){var s=a[i][e.property];e.initialValue=s,e.setValue(s)}}}}function De(n,e,t,i){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var r=void 0;if(i.color)r=new on(e,t);else{var o=[e,t].concat(i.factoryArgs);r=Lr.apply(n,o)}i.before instanceof Se&&(i.before=i.before.__li),Yn(n,r),S.addClass(r.domElement,"c");var a=document.createElement("span");S.addClass(a,"property-name"),a.innerHTML=r.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(r.domElement);var u=ln(n,s,i.before);return S.addClass(u,J.CLASS_CONTROLLER_ROW),r instanceof on?S.addClass(u,"color"):S.addClass(u,xr(r.getValue())),Fr(n,u,r),n.__controllers.push(r),r}function Re(n,e){return document.location.href+"."+e}function sn(n,e,t){var i=document.createElement("option");i.innerHTML=e,i.value=e,n.__preset_select.appendChild(i),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function Dn(n,e){e.style.display=n.useLocalStorage?"block":"none"}function jr(n){var e=n.__save_row=document.createElement("li");S.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),S.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",S.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",S.addClass(i,"button"),S.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",S.addClass(r,"button"),S.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",S.addClass(o,"button"),S.addClass(o,"revert");var a=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?L.each(n.load.remembered,function(c,m){sn(n,m,m===n.preset)}):sn(n,Ie,!1),S.bind(a,"change",function(){for(var c=0;c<n.__preset_select.length;c++)n.__preset_select[c].innerHTML=n.__preset_select[c].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(i),e.appendChild(r),e.appendChild(o),je){var s=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage"),f=document.getElementById("dg-save-locally");f.style.display="block",localStorage.getItem(Re(n,"isLocal"))==="true"&&u.setAttribute("checked","checked"),Dn(n,s),S.bind(u,"change",function(){n.useLocalStorage=!n.useLocalStorage,Dn(n,s)})}var l=document.getElementById("dg-new-constructor");S.bind(l,"keydown",function(c){c.metaKey&&(c.which===67||c.keyCode===67)&&Be.hide()}),S.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),Be.show(),l.focus(),l.select()}),S.bind(i,"click",function(){n.save()}),S.bind(r,"click",function(){var c=prompt("Enter a new preset name.");c&&n.saveAs(c)}),S.bind(o,"click",function(){n.revert()})}function Br(n){var e=void 0;n.__resize_handle=document.createElement("div"),L.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(o){return o.preventDefault(),n.width+=e-o.clientX,n.onResize(),e=o.clientX,!1}function i(){S.removeClass(n.__closeButton,J.CLASS_DRAG),S.unbind(window,"mousemove",t),S.unbind(window,"mouseup",i)}function r(o){return o.preventDefault(),e=o.clientX,S.addClass(n.__closeButton,J.CLASS_DRAG),S.bind(window,"mousemove",t),S.bind(window,"mouseup",i),!1}S.bind(n.__resize_handle,"mousedown",r),S.bind(n.__closeButton,"mousedown",r),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function un(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function $e(n,e){var t={};return L.each(n.__rememberedObjects,function(i,r){var o={},a=n.__rememberedObjectIndecesToControllers[r];L.each(a,function(s,u){o[u]=e?s.initialValue:s.getValue()}),t[r]=o}),t}function Dr(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function $n(n){n.length!==0&&Pr.call(window,function(){$n(n)}),L.each(n,function(e){e.updateDisplay()})}var Gn=J;var Jn=ct(Xn()),dn=document.getElementById("pendulum-canvas"),He=document.getElementById("trace-canvas"),re=He.getContext("2d"),te=new Ne(dn);te.config.rotating=!1;function Kn(){dn.width=window.innerWidth,dn.height=window.innerHeight,He.width=window.innerWidth,He.height=window.innerHeight,te.updateTransform()}window.addEventListener("resize",Kn);Kn();window.addEventListener("dblclick",()=>document.body.style.cursor=document.body.style.cursor=="none"?"default":"none");var ie=Number(window.localStorage.getItem("N")??2),Wn=Number(window.localStorage.getItem("dt")),Qn=Number(window.localStorage.getItem("substeps")??1),Hr=Number(window.localStorage.getItem("g")??5),xe=new Array(2*ie).fill(0).map((n,e)=>e<ie?Math.PI/2:0),Te=new Array(ie).fill(1),Zn=new Array(ie).fill(1),ze=[];ze[ie-1]=Zn[ie-1];for(let n=ie-2;n>=0;n--)ze[n]=ze[n+1]+Zn[n];var Ce=new Array(2*ie),We=new Array(ie).fill(0).map(n=>new Array().fill(0));te.zoomInto(U.fromValues(0,0),Math.min(window.innerWidth,window.innerHeight)/(2.5*ie));te.translate(U.fromValues(window.innerWidth/2,window.innerHeight/2));te.updateTransform();var ce={colors:{weights:"#ffff00",rods:"#808080",trace:"#0000ff",background:"#000000"},width:{weights:.16,rods:.04,trace:.01}},et=new Gn({name:"customize appearance"}),Je=et.addFolder("colors");Je.addColor(ce.colors,"weights");Je.addColor(ce.colors,"rods");Je.addColor(ce.colors,"trace").onChange(pn);Je.addColor(ce.colors,"background").onChange(n=>document.body.style.background=n);var mn=et.addFolder("width");mn.add(ce.width,"weights");mn.add(ce.width,"rods");mn.add(ce.width,"trace").onChange(pn);var fe=[];function pn(){if(re.clearRect(0,0,He.width,He.height),fe.length==0)return;re.strokeStyle=ce.colors.trace,re.lineCap="round",re.lineJoin="round",re.lineWidth=ce.width.trace;let n=te.transform.matrix();re.save(),re.setTransform(n[0],n[1],n[2],n[3],n[4],n[5]),re.beginPath(),re.moveTo(fe[0][0],fe[0][1]);for(let e=1;e<fe.length;e++)re.lineTo(fe[e][0],fe[e][1]);re.stroke(),re.restore()}te.addListener(pn);function zr(){document.body.style.backgroundColor=ce.colors.background,te.clearScreen();let n=U.create();te.ctx.strokeStyle=ce.colors.rods,te.ctx.lineJoin="round",te.ctx.lineWidth=ce.width.rods,te.ctx.beginPath(),te.ctx.moveTo(n[0],n[1]);for(let t=0;t<ie;t++)n[0]+=Te[t]*Math.sin(xe[t]),n[1]+=Te[t]*Math.cos(xe[t]),te.ctx.lineTo(n[0],n[1]);te.ctx.stroke(),U.set(n,0,0),te.ctx.fillStyle=ce.colors.weights,te.ctx.beginPath(),te.ctx.arc(n[0],n[1],ce.width.weights/2,0,Math.PI*2),te.ctx.fill();for(let t=0;t<ie;t++)n[0]+=Te[t]*Math.sin(xe[t]),n[1]+=Te[t]*Math.cos(xe[t]),te.ctx.beginPath(),te.ctx.arc(n[0],n[1],ce.width.weights/2,0,Math.PI*2),te.ctx.fill();if(fe.push(n),fe.length<2)return;re.strokeStyle=ce.colors.trace,re.lineCap="round",re.lineWidth=ce.width.trace;let e=te.transform.matrix();re.save(),re.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),re.beginPath(),re.moveTo(fe[fe.length-2][0],fe[fe.length-2][1]),re.lineTo(fe[fe.length-1][0],fe[fe.length-1][1]),re.stroke(),re.restore()}function Qe(n){for(let t=0;t<ie;t++){let i=-ze[t]*Te[t]*Hr*Math.sin(n[t]);for(let r=0;r<ie;r++){let o=ze[Math.max(t,r)]*Te[t]*Te[r];i+=o*n[r+ie]*n[r+ie]*Math.sin(n[r]-n[t]),t>r?We[t][r]=We[r][t]:We[t][r]=o*Math.cos(n[r]-n[t])}Ce[t]=i}let e=Jn.default.solve(We,Ce);for(let t=0;t<ie;t++)Ce[t]=n[t+ie];for(let t=0;t<ie;t++)Ce[t+ie]=e[t];return Ce.slice()}function Ur(n){function e(a,s,u){for(let f=0;f<2*ie;f++)Ce[f]=a[f]+u*s[f];return Ce.slice()}let t=Qe(xe),i=Qe(e(xe,t,n/2)),r=Qe(e(xe,i,n/2)),o=Qe(e(xe,r,n));for(let a=0;a<2*ie;a++)xe[a]+=(t[a]+2*(i[a]+r[a])+o[a])*n/6}var hn=0;function nt(n){let e=isNaN(Wn)?Math.min((n-hn)/1e3,.1):Wn;for(let t=0;t<Qn;t++)Ur(e/Qn);zr(),hn=n,requestAnimationFrame(nt)}requestAnimationFrame(n=>{hn=n,requestAnimationFrame(nt)});
