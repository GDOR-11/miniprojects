var F=Object.defineProperty;var z=(t,r)=>{for(var n in r)F(t,n,{get:r[n],enumerable:!0})};var x=1e-6,d=typeof Float32Array<"u"?Float32Array:Array,T=Math.random;var nr=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});var p={};z(p,{add:()=>it,clone:()=>W,copy:()=>X,create:()=>H,determinant:()=>Q,equals:()=>ct,exactEquals:()=>ht,frob:()=>at,fromRotation:()=>tt,fromScaling:()=>rt,fromTranslation:()=>nt,fromValues:()=>J,identity:()=>j,invert:()=>K,mul:()=>lt,multiply:()=>b,multiplyScalar:()=>ot,multiplyScalarAndAdd:()=>st,rotate:()=>U,scale:()=>Z,set:()=>G,str:()=>et,sub:()=>ft,subtract:()=>S,translate:()=>$});function H(){var t=new d(6);return d!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function W(t){var r=new d(6);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r}function X(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function j(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function J(t,r,n,e,a,i){var o=new d(6);return o[0]=t,o[1]=r,o[2]=n,o[3]=e,o[4]=a,o[5]=i,o}function G(t,r,n,e,a,i,o){return t[0]=r,t[1]=n,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t}function K(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],h=r[5],c=n*i-e*a;return c?(c=1/c,t[0]=i*c,t[1]=-e*c,t[2]=-a*c,t[3]=n*c,t[4]=(a*h-i*o)*c,t[5]=(e*o-n*h)*c,t):null}function Q(t){return t[0]*t[3]-t[1]*t[2]}function b(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],h=r[4],c=r[5],f=n[0],l=n[1],u=n[2],g=n[3],v=n[4],E=n[5];return t[0]=e*f+i*l,t[1]=a*f+o*l,t[2]=e*u+i*g,t[3]=a*u+o*g,t[4]=e*v+i*E+h,t[5]=a*v+o*E+c,t}function U(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],h=r[4],c=r[5],f=Math.sin(n),l=Math.cos(n);return t[0]=e*l+i*f,t[1]=a*l+o*f,t[2]=e*-f+i*l,t[3]=a*-f+o*l,t[4]=h,t[5]=c,t}function Z(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],h=r[4],c=r[5],f=n[0],l=n[1];return t[0]=e*f,t[1]=a*f,t[2]=i*l,t[3]=o*l,t[4]=h,t[5]=c,t}function $(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],h=r[4],c=r[5],f=n[0],l=n[1];return t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=e*f+i*l+h,t[5]=a*f+o*l+c,t}function tt(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=n,t[2]=-n,t[3]=e,t[4]=0,t[5]=0,t}function rt(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t[4]=0,t[5]=0,t}function nt(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=r[0],t[5]=r[1],t}function et(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function at(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function it(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t}function S(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t}function ot(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t}function st(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t[2]=r[2]+n[2]*e,t[3]=r[3]+n[3]*e,t[4]=r[4]+n[4]*e,t[5]=r[5]+n[5]*e,t}function ht(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]}function ct(t,r){var n=t[0],e=t[1],a=t[2],i=t[3],o=t[4],h=t[5],c=r[0],f=r[1],l=r[2],u=r[3],g=r[4],v=r[5];return Math.abs(n-c)<=x*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(e-f)<=x*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(a-l)<=x*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-u)<=x*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-g)<=x*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(h-v)<=x*Math.max(1,Math.abs(h),Math.abs(v))}var lt=b,ft=S;var s={};z(s,{add:()=>Mt,angle:()=>kt,ceil:()=>ut,clone:()=>mt,copy:()=>xt,create:()=>P,cross:()=>bt,dist:()=>Xt,distance:()=>q,div:()=>Wt,divide:()=>L,dot:()=>Rt,equals:()=>Vt,exactEquals:()=>Dt,floor:()=>gt,forEach:()=>Gt,fromValues:()=>pt,inverse:()=>zt,len:()=>Bt,length:()=>k,lerp:()=>St,max:()=>yt,min:()=>vt,mul:()=>Ht,multiply:()=>I,negate:()=>Et,normalize:()=>Tt,random:()=>Pt,rotate:()=>Ot,round:()=>At,scale:()=>wt,scaleAndAdd:()=>_t,set:()=>dt,sqrDist:()=>jt,sqrLen:()=>Jt,squaredDistance:()=>O,squaredLength:()=>N,str:()=>Ct,sub:()=>Ft,subtract:()=>Y,transformMat2:()=>Yt,transformMat2d:()=>It,transformMat3:()=>Lt,transformMat4:()=>qt,zero:()=>Nt});function P(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}function mt(t){var r=new d(2);return r[0]=t[0],r[1]=t[1],r}function pt(t,r){var n=new d(2);return n[0]=t,n[1]=r,n}function xt(t,r){return t[0]=r[0],t[1]=r[1],t}function dt(t,r,n){return t[0]=r,t[1]=n,t}function Mt(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t}function Y(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t}function I(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t}function L(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t}function ut(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t}function gt(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t}function vt(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t}function yt(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t}function At(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t}function wt(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t}function _t(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t}function q(t,r){var n=r[0]-t[0],e=r[1]-t[1];return Math.hypot(n,e)}function O(t,r){var n=r[0]-t[0],e=r[1]-t[1];return n*n+e*e}function k(t){var r=t[0],n=t[1];return Math.hypot(r,n)}function N(t){var r=t[0],n=t[1];return r*r+n*n}function Et(t,r){return t[0]=-r[0],t[1]=-r[1],t}function zt(t,r){return t[0]=1/r[0],t[1]=1/r[1],t}function Tt(t,r){var n=r[0],e=r[1],a=n*n+e*e;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t}function Rt(t,r){return t[0]*r[0]+t[1]*r[1]}function bt(t,r,n){var e=r[0]*n[1]-r[1]*n[0];return t[0]=t[1]=0,t[2]=e,t}function St(t,r,n,e){var a=r[0],i=r[1];return t[0]=a+e*(n[0]-a),t[1]=i+e*(n[1]-i),t}function Pt(t,r){r=r||1;var n=T()*2*Math.PI;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t}function Yt(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[2]*a,t[1]=n[1]*e+n[3]*a,t}function It(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[2]*a+n[4],t[1]=n[1]*e+n[3]*a+n[5],t}function Lt(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[3]*a+n[6],t[1]=n[1]*e+n[4]*a+n[7],t}function qt(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[4]*a+n[12],t[1]=n[1]*e+n[5]*a+n[13],t}function Ot(t,r,n,e){var a=r[0]-n[0],i=r[1]-n[1],o=Math.sin(e),h=Math.cos(e);return t[0]=a*h-i*o+n[0],t[1]=a*o+i*h+n[1],t}function kt(t,r){var n=t[0],e=t[1],a=r[0],i=r[1],o=Math.sqrt(n*n+e*e)*Math.sqrt(a*a+i*i),h=o&&(n*a+e*i)/o;return Math.acos(Math.min(Math.max(h,-1),1))}function Nt(t){return t[0]=0,t[1]=0,t}function Ct(t){return"vec2("+t[0]+", "+t[1]+")"}function Dt(t,r){return t[0]===r[0]&&t[1]===r[1]}function Vt(t,r){var n=t[0],e=t[1],a=r[0],i=r[1];return Math.abs(n-a)<=x*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(e-i)<=x*Math.max(1,Math.abs(e),Math.abs(i))}var Bt=k,Ft=Y,Ht=I,Wt=L,Xt=q,jt=O,Jt=N,Gt=function(){var t=P();return function(r,n,e,a,i,o){var h,c;for(n||(n=2),e||(e=0),a?c=Math.min(a*n+e,r.length):c=r.length,h=e;h<c;h+=n)t[0]=r[h],t[1]=r[h+1],i(t,t,o),r[h]=t[0],r[h+1]=t[1];return r}}();function Kt(t,r){let n=t[0],e=t[1],a=r[0],i=r[1];return Math.atan2(n*i-e*a,n*a+e*i)}var A=class t{constructor(r,n,e){this.translation=s.create(),this.zoom=1,this.rotation=0,this.translation=r||this.translation,this.zoom=n||this.zoom,this.rotation=e||this.rotation}translationMatrix(){return p.fromTranslation(p.create(),this.translation)}scalingMatrix(){return p.fromScaling(p.create(),[this.zoom,this.zoom])}rotationMatrix(){return p.fromRotation(p.create(),this.rotation)}matrix(){let r=p.create();return p.mul(r,this.translationMatrix(),this.scalingMatrix()),p.mul(r,r,this.rotationMatrix()),r}translate(r){s.add(this.translation,this.translation,r)}zoomInto(r,n){this.zoom*=n,s.sub(this.translation,this.translation,r),s.scaleAndAdd(this.translation,r,this.translation,n)}rotateAround(r,n){this.rotation+=n,s.rotate(this.translation,this.translation,r,n)}lerp(r,n){s.lerp(this.translation,this.translation,r.translation,n),this.zoom=(1-n)*this.zoom+n*r.zoom,this.rotation=(1-n)*this.rotation+n*r.rotation}copy(r){s.copy(this.translation,r.translation),this.zoom=r.zoom,this.rotation=r.rotation}apply(r){return s.transformMat2d(r,r,this.matrix())}inverse(){let r=s.negate(s.create(),this.translation);return s.scale(r,r,1/this.zoom),s.rotate(r,r,s.create(),-this.rotation),new t(r,1/this.zoom,-this.rotation)}},y=class{constructor(r){this._listeners=[],this.config={scroll_sensitivity:1.01,rotation_sensitivity:.01,damping_strength:0,panning:!0,zooming:!0,rotating:!0};let n=r instanceof HTMLCanvasElement?r.getContext("2d"):r;if(n===null)throw new Error("Failed to get CanvasRenderingContext2D");this.ctx=n,this.transform=new A,this.target_transform=new A,this.canvas.style.touchAction="none",Qt(this,this.canvas)}updateDamping(r,n=!0){this.transform.lerp(this.target_transform,1-Math.exp(-r/this.config.damping_strength)),n&&this.updateTransform()}updateTransform(){this.config.damping_strength===0&&this.transform.copy(this.target_transform),this.ctx.resetTransform(),this.ctx.translate(...this.transform.translation),this.ctx.rotate(this.transform.rotation),this.ctx.scale(this.transform.zoom,this.transform.zoom),this._listeners.forEach(r=>r(this))}renderSpaceToScreen(r){return this.transform.apply(r)}screenToRenderSpace(r){return this.transform.inverse().apply(r)}getScreenAABB(){let r=[s.fromValues(0,0),s.fromValues(0,this.canvas.height),s.fromValues(this.canvas.width,0),s.fromValues(this.canvas.width,this.canvas.height)].map(this.screenToRenderSpace.bind(this)),n=r.map(a=>a[0]),e=r.map(a=>a[1]);return[s.fromValues(Math.min(...n),Math.min(...e)),s.fromValues(Math.max(...n),Math.max(...e))]}translate(r){this.target_transform.translate(r)}zoomInto(r,n){this.target_transform.zoomInto(r,n)}rotateAround(r,n){this.target_transform.rotateAround(r,n)}lerp(r,n){this.target_transform.lerp(r,n)}addListener(r){this._listeners.push(r)}removeListener(r){this._listeners.splice(this._listeners.indexOf(r),1)}clearScreen(){this.ctx.save(),this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore()}get canvas(){return this.ctx.canvas}get listeners(){return this._listeners.slice()}};function Qt(t,r){let n={};r.addEventListener("contextmenu",e=>e.preventDefault()),r.addEventListener("pointerdown",e=>{n[e.pointerId]={pos:s.fromValues(e.offsetX,e.offsetY),button:e.button}}),r.addEventListener("pointerup",e=>{delete n[e.pointerId]}),r.addEventListener("pointermove",e=>{let a=n[e.pointerId];if(!a)return;let i=s.clone(a.pos);switch(s.set(a.pos,e.offsetX,e.offsetY),Object.keys(n).length){case 1:a.button===2&&t.config.rotating&&t.rotateAround([r.width/2,r.height/2],t.config.rotation_sensitivity*(a.pos[0]-i[0])),a.button==0&&t.config.panning&&t.translate(s.sub(s.create(),a.pos,i)),t.updateTransform();break;case 2:let o=Object.values(n).find(l=>l!==a);if(o===void 0)throw new Error("something is really wrong bro, good luck debugging ts");let h=s.add(s.create(),a.pos,o.pos);s.scale(h,h,.5);let c=s.sub(s.create(),a.pos,o.pos),f=s.sub(s.create(),i,o.pos);if(t.config.panning){let l=s.sub(s.create(),a.pos,i);t.translate(s.scale(l,l,.5))}t.config.zooming&&t.zoomInto(h,s.len(c)/s.len(f)),t.config.rotating&&t.rotateAround(h,Kt(f,c)),t.updateTransform();break}}),r.addEventListener("wheel",e=>{if(!t.config.zooming)return;let a=Math.pow(t.config.scroll_sensitivity,-e.deltaY);t.zoomInto([e.offsetX,e.offsetY],a),t.updateTransform(),e.preventDefault()},{passive:!1})}var _=document.getElementById("canvas"),m=_.getContext("2d"),M=new y(m);M.translate([window.innerWidth/2,window.innerHeight/2]);M.updateTransform();M.config.damping_strength=.05;M.config.rotating=!1;function V(){_.width=window.innerWidth,_.height=window.innerHeight}window.onresize=V;V();var w=t=>Math.sin(Math.tan(t));function C(t,r){return(r(t+1e-8)-r(t))*1e8}function Ut(){let t=M.getScreenAABB();m.strokeStyle="black",m.lineWidth=1/M.transform.zoom,m.lineCap="square",m.beginPath(),m.moveTo(t[0][0],0),m.lineTo(t[1][0],0),m.moveTo(0,t[0][1]),m.lineTo(0,t[1][1]),m.stroke()}function Zt(){let t=M.getScreenAABB();m.strokeStyle="black",m.lineWidth=2/M.transform.zoom,m.lineCap="round",m.lineJoin="round";let r=(t[1][0]-t[0][0])/16384,n=(t[1][0]-t[0][0])/256,e=a=>{let i=1/C(a,o=>C(o,w));return Math.max(r,Math.min(n,i))};m.beginPath(),m.moveTo(t[0][0],w(t[0][0]));for(let a=t[0][0];a<=t[1][0];a+=e(a))m.lineTo(a,w(a));m.stroke()}var D=performance.now();function B(){M.clearScreen(),M.updateDamping((performance.now()-D)/1e3),Zt(),Ut(),D=performance.now(),requestAnimationFrame(B)}requestAnimationFrame(B);
